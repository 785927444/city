import{_ as b}from"./Pagination.vue_vue_type_style_index_0_lang-Bbrys9lg.js";import{_ as A}from"./List.vue_vue_type_script_setup_true_lang-CRJw57K5.js";import{_ as v}from"./AaTitle.vue_vue_type_script_setup_true_lang-msvlqApB.js";import{_ as N}from"./filter-BWaskIWj.js";import{d as q,g as C,r as E,b as V,o as w,c as g,a as u,w as k,f as o,m as $,u as i,F as I,p as L,z as S,q as U,E as j,e as O,k as B,v as M,l as F}from"./index-BF5jje68.js";import"./el-pagination-CLehCad4.js";import"./el-image-viewer-DMRq40TL.js";import"./el-switch-DkPm2rNO.js";import"./select-CBJjauee.js";const P={class:"layout-col"},T={class:"flex-sc mr30"},z={class:"w50x4"},D={class:"flex-sc mr15"},H={class:"w50x4"},K={class:"layout-col white-rgba50 rad8 bo-i16-1"},G=q({__name:"m22",setup(J){const{proxy:r}=C(),m=r.publicStore();r.configStore();const t=E({...m.$state,content:[{width:"w50",show:!0,align:"center",key:"*",name:"序号"},{width:"w50x5",show:!0,align:"left",key:"name",name:"项目名称"},{width:"w50x5",show:!0,align:"left",key:"aera",name:"所属地区"},{width:"w50x5",show:!0,align:"left",key:"task_type",name:"任务类型",type:"select",list:[],value:"id",label:"name"},{width:"w50x5",show:!0,align:"left",key:"construct_scale",name:"建设规模"},{width:"w50x5",show:!0,align:"left",key:"construct_nature",name:"建设性质"},{width:"w50x5",show:!0,align:"left",key:"construct_price",name:"投资预估"},{width:"w50x5",show:!0,align:"left",key:"construct_datetime",name:"建设周期"}]});V(async()=>{await h(),y()});const h=async()=>{let f={model:"t_task_type"},e={model:"t_task_content"},l=await m.http({Api1:f,Api2:e});r.isNull(l.Api1)||l.Api1;let d=r.isNull(l.Api2)?[]:l.Api2;const _=l.Api1.filter(s=>s.parent_id==="0").map(s=>s.id),p=l.Api1.filter(s=>_.includes(s.parent_id)),n=l.Api1.filter(s=>p.map(c=>c.id).includes(s.parent_id));t.task_types=p,t.task_classs=n,t.construct_contents=d,t.content.forEach(s=>{s.key=="task_type"&&(s.list=[...p]),s.key=="task_class"&&(s.list=[...n]),s.key=="construct_content"&&(s.list=[...d])})},y=async f=>{let e={model:"t_scheme_project",args:`user_id='${m.active.user_id}' and type='plan'`};t.task_type&&(e.args+=` and task_type='${t.task_type}'`),t.name&&(e.args+=` and name LIKE '%${t.name}%'`);let l={limit:t.limit,page:t.page},d={field:"COUNT(*)"},_={},p={};Object.assign(_,e,l),Object.assign(p,e,d);let n=await m.http({Api1:_,Api2:p});t.empty=!!r.isNull(n.Api1),t.list=r.isNull(n.Api1)?[]:n.Api1,t.total=r.isNull(n.Api2)?0:n.Api2[0]["COUNT(*)"],r.isNull(m.form.project)||m.form.project.forEach(s=>{let c=t.list.find(a=>a.id==s);c&&(c.click=!0,t.clickArr.push(c))})},x=(f,e)=>{};return(f,e)=>{const l=U,d=$,_=j,p=N,n=v,s=A,c=b;return w(),g("div",P,[u(n,{title:""},{"left-content":k(()=>[o("div",T,[e[5]||(e[5]=o("span",{class:"mr10"},"项目类型",-1)),o("span",z,[u(d,{modelValue:i(t).task_type,"onUpdate:modelValue":e[0]||(e[0]=a=>i(t).task_type=a),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{default:k(()=>[(w(!0),g(I,null,L(i(t).task_types,(a,Q)=>(w(),S(l,{key:a.id,value:String(a.id),label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),o("div",D,[e[6]||(e[6]=o("span",{class:"mr10"},"项目名称",-1)),o("span",H,[u(_,{modelValue:i(t).name,"onUpdate:modelValue":e[1]||(e[1]=a=>i(t).name=a),placeholder:"请输入",style:{width:"100%"},filterable:"",clearabl:""},null,8,["modelValue"])])]),o("div",{class:"rad4 ptb6 plr12 flex-cc cursor bgi1 white",onClick:e[2]||(e[2]=O(a=>{i(t).page=1,y()},["stop"]))},[u(p,{class:"f12 fw"}),e[7]||(e[7]=o("span",{class:"f14 ml5"},"搜索",-1))])]),"right-content":k(()=>[...e[8]||(e[8]=[])]),_:1}),o("div",K,[u(s,{onHandleClick:x,state:i(t)},null,8,["state"])]),B(u(c,{class:"",style:{"padding-bottom":"0"},total:i(t).total,page:i(t).page,"onUpdate:page":e[3]||(e[3]=a=>i(t).page=a),pageModifiers:{sync:!0},limit:i(t).limit,"onUpdate:limit":e[4]||(e[4]=a=>i(t).limit=a),limitModifiers:{sync:!0},onPagination:y},null,8,["total","page","limit"]),[[M,i(t).total>0]])])}}}),it=F(G,[["__scopeId","data-v-dfd49a29"]]);export{it as default};
