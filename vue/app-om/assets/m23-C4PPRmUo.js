import{d as v,g as q,r as C,b as S,o as g,c as E,a as m,w as _,f,u as l,k,z as F,t as w,h as $,v as I,l as M}from"./index-C0LFq0t5.js";import{v as B}from"./el-loading-D7qlqRqj.js";import{_ as L}from"./Pagination.vue_vue_type_style_index_0_lang-BA7bW-pp.js";/* empty css                        *//* empty css                    */import{_ as O}from"./AaTitle.vue_vue_type_script_setup_true_lang-BnIAtUUF.js";import{a as T,E as U}from"./index-DJZt49th.js";import"./el-pagination-BB8JCOIr.js";import"./index-DefrYvvh.js";const j={class:"layout-col"},V={class:"layout-col"},D=v({__name:"m23",setup(P){const{proxy:r}=q(),u=r.publicStore(),h=r.configStore(),t=C({...u.$state,content:[{width:"w50",show:!0,align:"center",key:"*",name:"序号"},{width:"w50x5",show:!0,align:"left",key:"name",name:"项目名称"},{width:"w50x6",show:!0,align:"left",key:"task_type",name:"任务类型",type:"select",list:[],value:"id",label:"name"},{width:"w50x6",show:!0,align:"left",key:"task_class",name:"类型中类",type:"select",list:[],value:"id",label:"name"},{width:"w50x6",show:!0,align:"left",key:"construct_content",name:"建设内容",type:"select",list:[],value:"id",label:"name"},{width:"w50x6",show:!0,align:"left",key:"unit_target",name:"量化目标"}]}),b=i=>parseInt(t.page)+i,A=({row:i,column:s,rowIndex:a,columnIndex:n})=>{if(n===1)return a===0?{rowspan:t.total,colspan:1}:{rowspan:0,colspan:0}};S(async()=>{await N(),y()});const N=async()=>{let i={model:"t_task_type"},s={model:"t_task_content"},a=await u.http({Api1:i,Api2:s});r.isNull(a.Api1)||a.Api1;let n=r.isNull(a.Api2)?[]:a.Api2;const d=a.Api1.filter(e=>e.parent_id==="0").map(e=>e.id),c=a.Api1.filter(e=>d.includes(e.parent_id)),o=a.Api1.filter(e=>c.map(p=>p.id).includes(e.parent_id));t.task_types=c,t.task_classs=o,t.construct_contents=n,t.content.forEach(e=>{e.key=="task_type"&&(e.list=[...c]),e.key=="task_class"&&(e.list=[...o]),e.key=="construct_content"&&(e.list=[...n])})},y=async i=>{let s={model:"t_scheme_task",args:`user_id='${h.user.id}' and type='plan'`},a={limit:t.limit,page:t.page},n={field:"COUNT(*)"},d={},c={};Object.assign(d,s,a),Object.assign(c,s,n);let o=await u.http({Api1:d,Api2:c});t.empty=!!r.isNull(o.Api1),t.list=r.isNull(o.Api1)?[]:o.Api1,t.total=r.isNull(o.Api2)?0:o.Api2[0]["COUNT(*)"],r.isNull(u.form.task)||u.form.task.forEach(e=>{let p=t.list.find(x=>x.id==e);p&&(p.click=!0,t.clickArr.push(p))})};return(i,s)=>{const a=O,n=T,d=U,c=L,o=B;return g(),E("div",j,[m(a,{title:""},{"left-content":_(()=>[...s[2]||(s[2]=[f("div",{class:"flex-sc mr15"},[f("span",{class:"mr10 f16"},"规划目标")],-1)])]),"right-content":_(()=>[...s[3]||(s[3]=[])]),_:1}),f("div",V,[i.isNull(l(t).list)?$("",!0):k((g(),F(d,{key:0,"header-cell-class-name":"bgi16 c3","cell-style":{"background-color":"#FFFFFF",color:"#626366"},"span-method":A,border:"","empty-text":"暂无数据",data:l(t).list,stripe:""},{default:_(()=>[m(n,{type:"index",index:b,label:"序号",align:"center",width:"50"}),m(n,{label:"中央《意见》任务名称",align:"center"},{default:_((e,p)=>[f("span",null,w(!i.isNull(l(t).task_types)&&e.row.task_type?i.find(l(t).task_types,["id",e.row.task_type],"name"):""),1)]),_:1}),m(n,{label:"涉及的重点建设内容",align:"center"},{default:_((e,p)=>[f("span",null,w(!i.isNull(l(t).task_classs)&&e.row.task_class?i.find(l(t).task_classs,["id",e.row.task_class],"name"):""),1)]),_:1}),m(n,{prop:"unit_target",label:"项目量化目标",width:"150",align:"center"})]),_:1},8,["data"])),[[o,l(t).loading,void 0,{fullscreen:!0,lock:!0}]])]),k(m(c,{class:"",style:{"padding-bottom":"0"},total:l(t).total,page:l(t).page,"onUpdate:page":s[0]||(s[0]=e=>l(t).page=e),pageModifiers:{sync:!0},limit:l(t).limit,"onUpdate:limit":s[1]||(s[1]=e=>l(t).limit=e),limitModifiers:{sync:!0},onPagination:y},null,8,["total","page","limit"]),[[I,l(t).total>0]])])}}}),Y=M(D,[["__scopeId","data-v-ff70d108"]]);export{Y as default};
