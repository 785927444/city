import{d as w,g as J,r as O,ce as B,b as E,o as I,c as T,f as _,t as F,u as o,e as M,a as f,k as m,v as y,a6 as C,a9 as D,aa as L}from"./index-BF5jje68.js";import{_ as P}from"./stepTitle.vue_vue_type_script_setup_true_lang-DEd1lO9Y.js";import V from"./step1-BU0OrXDm.js";import j from"./step2-AbvkHou9.js";import R from"./step3-Bp3oisE2.js";import"./index-CND7x1jx.js";import"./FileList.vue_vue_type_script_setup_true_lang-CjQZZdnb.js";import"./ViewFiles-C92c8QO4.js";import"./question-filled-BgQjHn-S.js";/* empty css                    *//* empty css                   */import"./index-CU8Q0z-M.js";/* empty css                                                                   *//* empty css                    */import"./areaData-CfkeTXdx.js";import"./projects.vue_vue_type_script_setup_true_lang-Be91YboU.js";import"./el-loading-DNd19Xuc.js";import"./Pagination.vue_vue_type_style_index_0_lang-Bbrys9lg.js";import"./el-pagination-CLehCad4.js";/* empty css                        */import"./AaTitle.vue_vue_type_script_setup_true_lang-msvlqApB.js";import"./index-fed1VsgQ.js";import"./index-VYQ43fvS.js";import"./v6-B4YtUg27.js";const z={class:"layout-col plr15"},G={class:"layout-col white-rgba50 rad8"},H={class:"ww100 flex-bc f20 p15 mb20 bob-cd-1"},K={class:"fw"},Q={class:"flex1 flex-ec"},U={class:"layout-col"},Nt=w({__name:"index",setup(W){const d=C(),{proxy:p}=J(),s=p.publicStore();p.configStore();const a=O({...s.$state});B(async()=>{s.actIndex=1,s.form={}}),E(async()=>{h()});const h=async i=>{let t={};if(d.query&&d.query.id){let e={model:"t_project_report",args:`id='${d.query.id}'`},c=await s.http({Api:e});t=p.isNull(c)?{}:{...c[0]},t.apply_status=="0"&&(s.title="apply"),t.apply_status=="1"&&t.reserve_status=="0"&&(s.title="reserve")}if(t.area)try{t.area=JSON.parse(t.area)}catch(e){console.error("解析失败:",e.message)}else t.area=[];if(t.fund_source)try{t.fund_source=JSON.parse(t.fund_source)}catch(e){console.error("解析失败:",e.message)}else t.fund_source={value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",value7:"",value8:"",value9:"",value10:""};if(t.orther_text)try{t.orther_text=JSON.parse(t.orther_text)}catch(e){console.error("解析失败:",e.message)}else t.orther_text={value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",value7:"",value8:"",value9:"",value10:"",value11:"",value12:"",value13:"",value14:"",value15:""};if(t.attr)try{t.attr=JSON.parse(t.attr)}catch(e){console.error("解析失败:",e.message)}else t.attr={};if(t.plan_attr)try{t.plan_attr=JSON.parse(t.plan_attr)}catch(e){console.error("解析失败:",e.message)}else t.plan_attr={};if(t.has_attr)try{t.has_attr=JSON.parse(t.has_attr)}catch(e){console.error("解析失败:",e.message)}else t.has_attr={};s.form={...t},s._public.form=JSON.parse(JSON.stringify(t)),v(),g(),b(),N(),A()},v=async()=>{let i={model:"t_scheme_plan",args:"release_status='1'",field:"id, name"};s.http({Api:i}).then(t=>{s._public.schemePlans=p.isNull(t)?[]:t})},g=async()=>{s._public.schemeAreas=[{id:"1",name:"龙城片区"}]},b=async()=>{let i={model:"t_task_type"},t={model:"t_task_content"};s.http({Api1:i,Api2:t}).then(e=>{p.isNull(e.Api1)||e.Api1;let c=p.isNull(e.Api2)?[]:e.Api2;const n=e.Api1.filter(l=>l.parent_id==="0").map(l=>l.id),r=e.Api1.filter(l=>n.includes(l.parent_id)),u=e.Api1.filter(l=>r.map(q=>q.id).includes(l.parent_id));s._public.task_types=r,s._public.task_classs=u,s._public.construct_contents=c})},N=async()=>{let i={model:"t_scheme_task",args:`scheme_id='${s.form.scheme_id}'`};s.http({Api:i}).then(t=>{let e=p.isNull(t)?[]:t;s.form.tasks=[...t],s._public.tasks=JSON.parse(JSON.stringify(e))})},A=async()=>{let i={model:"t_file_type"},t={model:"t_file_content"},e=await s.http({Api1:i,Api2:t}),c=p.isNull(e.Api1)?[]:e.Api1.sort((r,u)=>r.orderd-u.orderd),n=p.isNull(e.Api2)?[]:e.Api2.sort((r,u)=>r.orderd-u.orderd);x(c,n,"019c2c63-cf59-719f-b942-7c7bb535413d"),k(c,n,"019c2cc4-d276-7805-9685-7a5dde449721"),$(c,n,"019c385a-6706-7a8e-aafa-f4b68eb0a81f")},x=(i,t,e)=>{let c=i.find(n=>n.id==e);if(c){let n=[];a.plans1=i.filter(r=>r.parent_id==e),a.plans1.forEach(r=>{r.parent_type=`${c.type}/${r.type}`;let u=t.filter(l=>l.parent_id==r.id);p.isNull(u)||u.forEach(l=>{l.parent_type=`${r.parent_type}/${l.type}`,n.push(l)})}),a.contents1=n,s._public.contents1=n,a.active1=p.isNull(a.plans1)?{}:{...a.plans1[0]}}},k=(i,t,e)=>{let c=i.find(n=>n.id==e);if(c){let n=[];a.plans2=i.filter(r=>r.parent_id==e),a.plans2.forEach(r=>{r.parent_type=`${c.type}/${r.type}`;let u=t.filter(l=>l.parent_id==r.id);p.isNull(u)||u.forEach(l=>{l.parent_type=`${r.parent_type}/${l.type}`,n.push(l)})}),a.contents2=n,s._public.contents2=n,a.active2=p.isNull(a.plans2)?{}:{...a.plans2[0]}}},$=(i,t,e)=>{let c=i.find(n=>n.id==e);if(c){let n=[];a.plans3=i.filter(r=>r.parent_id==e),a.plans3.forEach(r=>{r.parent_type=`${c.type}/${r.type}`;let u=t.filter(l=>l.parent_id==r.id);p.isNull(u)||u.forEach(l=>{l.parent_type=`${r.parent_type}/${l.type}`,n.push(l)})}),a.contents3=n,s._public.contents3=n,a.active3=p.isNull(a.plans3)?{}:{...a.plans3[0]}}},S=()=>{let i=s.form.id?"正在编辑中,是否确定退出?":"正在编辑中,信息未保存是否确定退出?";D.confirm(i,"温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{L.back()})};return(i,t)=>(I(),T("div",z,[_("div",G,[_("div",H,[_("div",K,F(o(d).query&&o(d).query.id?"创建项目":"信息补充"),1),_("div",Q,[_("div",{class:"plr14 ptb5 rad4 mr15 cursor c9 bg-white bo-c9-1",onClick:t[0]||(t[0]=M(e=>S(),["stop"]))},"返 回")])]),_("div",U,[f(o(P)),m(f(o(V),{state:o(a),contents:o(a).contents1,active:o(a).active1,plans:o(a).plans1},null,8,["state","contents","active","plans"]),[[y,o(s).actIndex==1]]),m(f(o(j),{state:o(a),contents:o(a).contents2,active:o(a).active2,plans:o(a).plans2},null,8,["state","contents","active","plans"]),[[y,o(s).actIndex==2]]),m(f(o(R),{state:o(a),contents:o(a).contents3,active:o(a).active3,plans:o(a).plans3},null,8,["state","contents","active","plans"]),[[y,o(s).actIndex==3]])])])]))}});export{Nt as default};
