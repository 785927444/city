import{d as M,g as j,a6 as z,r as D,b as L,o as c,c as m,a as d,w as _,f as l,e as f,a8 as H,u as a,m as K,F as x,p as h,z as C,q as G,E as J,t as r,h as I,y as T,k as Q,v as W,a0 as X,a1 as q,a2 as Z,a9 as tt,a4 as O,l as et}from"./index-BF5jje68.js";import{_ as st}from"./Pagination.vue_vue_type_style_index_0_lang-Bbrys9lg.js";import{_ as lt}from"./check-DrP440r6.js";import{_ as at}from"./AaTitle.vue_vue_type_script_setup_true_lang-msvlqApB.js";import{_ as it}from"./filter-BWaskIWj.js";import"./el-pagination-CLehCad4.js";const nt={class:"layout-col"},ot={class:"flex-sc mr30"},ct={class:"w50x4"},rt={class:"flex-sc mr30"},pt={class:"w50x3"},dt={class:"flex-sc mr30"},ut={class:"w50x3"},mt={class:"flex-sc mr15"},_t={class:"w50x3"},ft={class:"flex-sc mr15"},yt={class:"w50x3"},wt={class:"layout-col bg-white rad8 p8"},gt={class:"ww100 flex-sc p8"},bt={class:"flex-sc fw f16 tc"},vt=["onClick"],kt={key:0,class:"w20 h20 rad2 lh20 tc bgi13 i15 b20 l50 absolute"},xt={class:"mb5"},ht={class:"flex-ec flex1"},$t={class:"table flex-sc warp"},Ct={class:"ww100 bs bo-i16-1 relative rad8"},Vt={class:"ww100 flex-sc p12 bob-ce-1"},At={class:"f15"},Nt={class:"flex1 flex-ec"},Et=["onClick"],Ut={class:"ww100 flex-col p12 c6"},St={class:"ww100 flex-sc"},It={class:"ww100 flex-sc mt10"},Tt={class:"ww100 flex-sc mt10"},qt={class:"ww100 flex-sc mt10"},Ot={class:"ww100 flex-sc mt10"},Bt={class:"ww100 flex-sc mt10"},Ft={class:"ww100 flex-sc mt10"},Rt={class:"flex-sc flex1"},Yt=["onClick"],Pt={class:"dialog-footer"},Mt=M({__name:"index",setup(jt){const{proxy:p}=j(),v=p.publicStore(),w=p.configStore(),B=p.dictStore();z();const s=D({...v.$state,click:!1,clickArr:[],provinces:[],province:"",citys:[],city:"",types:[{type:"actionRelease",name:"已上报",path:"/actionRelease"},{type:"actionRelease1",name:"已申请",path:"/actionRelease1"},{type:"actionRelease2",name:"已退回",path:"/actionRelease2"}],type:"actionRelease",completion_status:"1",search:"",schemeAreas:[{value:"1",name:"龙城片区"}]});L(async()=>{await F(),V()});const F=async()=>{s.provinces=[{name:w.user.province_name,value:w.user.province}],s.province=s.provinces[0].value;let n=w.user.parent_id=="0"?{model:"t_station",args:`parent_id='${w.user.station_num}'`}:{model:"t_station",args:`id='${w.user.station_num}'`},t=await v.http({Api:n}),g=p.isNull(t)?[]:t.sort((i,b)=>i.order-b.order);s.citys=g.map(i=>({name:i.station_name,value:i.city})),!p.isNull(s.citys)&&w.user.parent_id!="0"&&(s.city=s.citys[0].value)},V=async n=>{let t="t_project_report",g="apply_status = '0' and reserve_status ='0'",i="apply_status = '1' and reserve_status ='0'",b="apply_status = '3' and reserve_status ='0'",u={model:t,args:g},A={model:t,field:"COUNT(*)",args:i},N={model:t,field:"COUNT(*)",args:b};if(R(A),Y(N),s.province){if(u.args+=` and province='${s.province}'`,s.city&&(u.args+=` and city='${s.city}'`),!p.isNull(s.construct_datetime)){const[o,P]=s.construct_datetime;u.args+=` and construct_datetime_start>='${o}' and construct_datetime_end<='${P}'`}s.completion_status&&(u.args+=` and completion_status='${s.completion_status}'`),s.search&&(u.args+=` and name LIKE '%${s.search}%'`)}let E={limit:s.limit,page:s.page},U={field:"COUNT(*)"},k={},$={};Object.assign(k,u,E),Object.assign($,u,U);let e=await v.http({Api1:k,Api2:$});s.total=p.isNull(e.Api2)?0:e.Api2[0]["COUNT(*)"];let y=s.types.find(o=>o.type==s.type);y.total=s.total,s.empty=!!p.isNull(e.Api1),s.list=p.isNull(e.Api1)?[]:e.Api1,s.list.forEach(o=>{o.area=(o.province_name||"")+(o.city_name?`-${o.city_name}`:"")+(o.district_name?`-${o.district_name}`:"")})},R=n=>{v.http({Api:n}).then(t=>{s.types[1].total=p.isNull(t)?0:t[0]["COUNT(*)"]})},Y=n=>{v.http({Api:n}).then(t=>{s.types[2].total=p.isNull(t)?0:t[0]["COUNT(*)"]})},S=(n,t)=>{n=="remind"&&tt.confirm("是否确定提醒?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{if(s.list.findIndex(i=>i.click)==-1)return O({title:"提示",message:"请选择至少一个",type:"error"});O({title:"提示",message:"提醒成功",type:"success"})}),n=="selectAll"&&(s.list.findIndex(i=>i.click)==-1?(s.click=!0,s.list.forEach(i=>{i.click=!0,s.clickArr.push(i)})):(s.click=!1,s.clickArr=[],s.list.forEach(i=>{delete i.click})))};return(n,t)=>{const g=H,i=G,b=K,u=J,A=it,N=at,E=lt,U=st,k=X,$=Z;return c(),m("div",nt,[d(N,{title:""},{"left-content":_(()=>[l("div",ot,[t[15]||(t[15]=l("span",{class:"mr10"},"项目周期",-1)),l("span",ct,[d(g,{style:{width:"100%"},modelValue:a(s).construct_datetime,"onUpdate:modelValue":t[0]||(t[0]=e=>a(s).construct_datetime=e),"start-placeholder":"开始周期","end-placeholder":"结束周期",type:"yearrange","value-format":"YYYY",format:"YYYY"},null,8,["modelValue"])])]),l("div",rt,[t[16]||(t[16]=l("span",{class:"mr10"},"所属行政",-1)),l("span",pt,[d(b,{modelValue:a(s).province,"onUpdate:modelValue":t[1]||(t[1]=e=>a(s).province=e),placeholder:"请选择",style:{width:"100%"},filterable:""},{default:_(()=>[(c(!0),m(x,null,h(a(s).provinces,(e,y)=>(c(),C(i,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",dt,[t[17]||(t[17]=l("span",{class:"mr10"},"所属地市",-1)),l("span",ut,[d(b,{modelValue:a(s).city,"onUpdate:modelValue":t[2]||(t[2]=e=>a(s).city=e),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:a(w).user.parent_id=="0"},{default:_(()=>[(c(!0),m(x,null,h(a(s).citys,(e,y)=>(c(),C(i,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","clearable"])])]),l("div",mt,[t[18]||(t[18]=l("span",{class:"mr10"},"实施状态",-1)),l("span",_t,[d(b,{modelValue:a(s).completion_status,"onUpdate:modelValue":t[3]||(t[3]=e=>a(s).completion_status=e),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{default:_(()=>[(c(!0),m(x,null,h(a(B).project_completion_statuss,(e,y)=>(c(),C(i,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",ft,[t[19]||(t[19]=l("span",{class:"mr10"},"项目名称",-1)),l("span",yt,[d(u,{modelValue:a(s).search,"onUpdate:modelValue":t[4]||(t[4]=e=>a(s).search=e),style:{width:"100%"},placeholder:"请输入"},null,8,["modelValue"])])]),l("div",{class:"rad4 ptb6 plr12 flex-cc cursor bgi1 white",onClick:t[5]||(t[5]=f(e=>V(),["stop"]))},[d(A,{class:"f12 fw"}),t[20]||(t[20]=l("span",{class:"f14 ml5"},"搜索",-1))])]),"right-content":_(()=>[l("div",{class:"rad4 ptb6 plr12 flex-cc cursor ml15 bg-white c8 bo-cc-1",onClick:t[6]||(t[6]=f(e=>n.toPath("/actionApply"),["stop"]))},"新建项目"),l("div",{class:"rad4 ptb6 plr12 flex-cc cursor ml15 bgi1 white",onClick:t[7]||(t[7]=f(e=>n.toPath("/actionHome"),["stop"]))},"项目库")]),_:1}),l("div",wt,[l("div",gt,[l("div",bt,[(c(!0),m(x,null,h(a(s).types,(e,y)=>(c(),m("div",{class:"mr40 cursor flex-col-cc relative",key:y,onClick:f(o=>n.toPath(e.path),["stop"])},[e.total?(c(),m("span",kt,r(e.total),1)):I("",!0),l("span",xt,r(e.name),1),l("span",{class:T(["ww100 h3 rad10",e.type==a(s).type?"bgi2":"black-rgba0"])},null,2)],8,vt))),128))]),l("div",ht,[l("div",{class:"rad4 ptb5 plr12 flex-cc cursor bg-white c8 bo-cc-1 ml15",onClick:t[8]||(t[8]=f(e=>S("selectAll"),["stop"]))},"全选"),l("div",{class:"rad4 ptb5 plr12 flex-cc cursor bgi1 white bo-i1-1 ml15",onClick:t[9]||(t[9]=f(e=>S("remind"),["stop"]))},"提醒")])]),l("div",$t,[(c(!0),m(x,null,h(a(s).list,(e,y)=>(c(),m("div",{class:"ww25 cursor p8",key:y},[l("div",Ct,[l("div",Vt,[l("span",At,r(e.name),1),l("span",Nt,[l("span",{class:T(["w18 h18 tc lh18 rad3 ml10 white f12",e.click?"bgi1 bo-i1-1":"bo-cc-1"]),onClick:f(o=>e.click=!e.click,["stop"])},[e.click?(c(),C(E,{key:0})):I("",!0)],10,Et)])]),l("div",Ut,[l("div",St,[t[21]||(t[21]=l("span",{class:"w110"},"所属地区",-1)),l("span",null,r(e.province_name?e.province_name:"")+r(e.city_name?`-${e.city_name}`:"")+r(e.district_name?`-${e.district_name}`:""),1)]),l("div",It,[t[22]||(t[22]=l("span",{class:"w110"},"所属片区",-1)),l("span",null,r(e.parent_area?n.find(a(s).schemeAreas,["value",e.parent_area],"name"):"-"),1)]),l("div",Tt,[t[23]||(t[23]=l("span",{class:"w110"},"项目周期",-1)),l("span",null,r(e.construct_datetime_start&&e.construct_datetime_end?`${e.construct_datetime_start}-${e.construct_datetime_end}`:"-"),1)]),l("div",qt,[t[24]||(t[24]=l("span",{class:"w110"},"项目规模",-1)),l("span",null,r(e.construct_scale?`${e.construct_scale}`:"-"),1)]),l("div",Ot,[t[25]||(t[25]=l("span",{class:"w110"},"预估投入",-1)),l("span",null,r(e.construct_price?`${e.construct_price} 万元`:"-"),1)]),l("div",Bt,[t[26]||(t[26]=l("span",{class:"w110"},"项目性质",-1)),l("span",null,r(e.construct_nature?n.decrypt(e.construct_nature):"-"),1)]),l("div",Ft,[l("div",Rt,[t[27]||(t[27]=l("span",{class:"w110"},"更新进度时间",-1)),l("span",null,r(e.update_time?n.parseTime(e.update_time):"-"),1)]),l("div",{class:"rad5 ptb5 plr12 cursor bgi1 white",onClick:f(o=>{a(s).active={...e},a(s).isFalse=!a(s).isFalse},["stop"])},"申请储备",8,Yt)])])])]))),128))]),Q(d(U,{class:"",style:{"padding-bottom":"0"},total:a(s).total,page:a(s).page,"onUpdate:page":t[10]||(t[10]=e=>a(s).page=e),pageModifiers:{sync:!0},limit:a(s).limit,"onUpdate:limit":t[11]||(t[11]=e=>a(s).limit=e),limitModifiers:{sync:!0},onPagination:V},null,8,["total","page","limit"]),[[W,a(s).total>0]])]),d($,{modelValue:a(s).isFalse,"onUpdate:modelValue":t[14]||(t[14]=e=>a(s).isFalse=e),title:"温馨提示",draggable:!0,width:"30%"},{footer:_(()=>[l("div",Pt,[d(k,{size:"large",class:"bgc white",onClick:t[12]||(t[12]=e=>a(s).isFalse=!a(s).isFalse)},{default:_(()=>[...t[28]||(t[28]=[q("取 消",-1)])]),_:1}),d(k,{size:"large",class:"bgi1 white",onClick:t[13]||(t[13]=f(e=>n.toPath("/actionApply",{id:a(s).active.id}),["stop"]))},{default:_(()=>[...t[29]||(t[29]=[q("确 定",-1)])]),_:1})])]),default:_(()=>[t[30]||(t[30]=l("div",{class:"ww100 flex-col-cc"},[l("div",{class:"f20 tc ptb30"},"是否将该项目申请纳入储备")],-1))]),_:1},8,["modelValue"])])}}}),Jt=et(Mt,[["__scopeId","data-v-3326f7da"]]);export{Jt as default};
