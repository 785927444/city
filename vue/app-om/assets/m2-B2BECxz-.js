import{_ as x}from"./Add-C2Yn49FZ.js";import{_ as C}from"./Pagination.vue_vue_type_style_index_0_lang-CMYQ1dta.js";import{_ as q}from"./List.vue_vue_type_script_setup_true_lang-But96V8i.js";import{_ as A}from"./AaTitle.vue_vue_type_script_setup_true_lang-Dok3GIN-.js";import{d as I,g as N,r as V,j as $,o as y,c as g,a as r,w,u as i,e as h,_ as S,f as u,t as j,h as O,E as U,k as E,v as B,i as M,n as P,l as T}from"./index-BWjCSAnw.js";import"./el-progress-DQWPeYlj.js";import"./Upload-D7KlxVMi.js";import"./el-message-CJx4xv24.js";import"./el-text-Ck7yMuci.js";import"./el-checkbox-DlSjzc6V.js";import"./el-pagination-20-n38jk.js";import"./el-image-viewer-HQ-b3oKZ.js";import"./el-switch-i6AGQHxo.js";import"./select-quGGAc_E.js";const D={class:"layout-col"},L={class:"flex-sc"},R={class:"f14 ml2"},F={class:"layout-col white-rgba50 rad8 p15"},H=I({__name:"m2",setup(K){const{proxy:a}=N(),l=a.publicStore();a.configStore(),a.dictStore();let d=M();const t=V({...l.$state,content:[{width:"w60",show:!0,align:"center",key:"*",name:"序号"},{width:"flex1",show:!0,align:"center",key:"name",name:"涉及的重点建设内容"},{width:"w50x4",show:!0,align:"center",key:"unit",name:"量化单位"},{width:"w50x4",show:!0,align:"right",key:{add:"新增",start:"启用",upd:"编辑",del:"删除"},name:"操作"}],editFrom:[{required:!0,editshow:"none",name:"上级",key:"parent_id",type:"input"},{required:!0,editshow:!0,name:"建设内容",key:"name",type:"input"},{required:!0,editshow:!0,name:"量化单位",key:"unit",type:"input"},{required:!1,editshow:!0,name:"标识",key:"type",type:"input"},{required:!1,editshow:!0,name:"排序",key:"orderd",type:"input"}],addItem:{},model:"t_task_content"});$(()=>l.active,async o=>{a.isNull(o)||(await P(),t.addItem={parent_id:o.id},await k(),p())},{immediate:!1,deep:!0});const k=async()=>{},p=async o=>{let e={model:t.model,args:`parent_id='${l.active.id}'`,order:"orderd ASC"};t.search&&(e.args+=` and name LIKE '%${t.search}%'`);let _={limit:t.limit,page:t.page},f={field:"COUNT(*)"},c={},m={};Object.assign(c,e,_),Object.assign(m,e,f);let s=await l.http({Api1:c,Api2:m});t.empty=!!a.isNull(s.Api1),t.list=a.isNull(s.Api1)?[]:s.Api1,t.total=a.isNull(s.Api2)?0:s.Api2[0]["COUNT(*)"]},b=async(o,e)=>{(o=="add"||o=="upd")&&d.value.onVisable(e),o=="del"&&d.value.del(e)};return(o,e)=>{const _=U,f=S,c=A,m=q,s=C,v=x;return y(),g("div",D,[r(c,{title:""},{"left-content":w(()=>[u("div",L,[r(_,{modelValue:i(t).search,"onUpdate:modelValue":e[0]||(e[0]=n=>i(t).search=n),placeholder:"请输入"},null,8,["modelValue"]),u("div",{class:"rad4 ptb5 w80 flex-cc cursor bgi1 white ml10",onClick:e[1]||(e[1]=h(n=>{i(t).page=1,p()},["stop"]))},"搜索")])]),"right-content":w(()=>[i(t).content.find(n=>typeof n.key=="object")&&i(t).content.find(n=>typeof n.key=="object").key.hasOwnProperty("add")?(y(),g("div",{key:0,class:"rad4 ptb5 plr8 flex-cc cursor bgi1 white ml10",onClick:e[2]||(e[2]=h(n=>i(d).onVisable(i(t).addItem),["stop"]))},[r(f,{class:"f12 fw"}),u("span",R,j(i(t).content.find(n=>typeof n.key=="object").key.add),1)])):O("",!0)]),_:1}),u("div",F,[r(m,{onHandleClick:b,state:i(t)},null,8,["state"]),E(r(s,{class:"",style:{"padding-bottom":"0"},total:i(t).total,page:i(t).page,"onUpdate:page":e[3]||(e[3]=n=>i(t).page=n),pageModifiers:{sync:!0},limit:i(t).limit,"onUpdate:limit":e[4]||(e[4]=n=>i(t).limit=n),limitModifiers:{sync:!0},onPagination:p},null,8,["total","page","limit"]),[[B,i(t).total>0]])]),r(v,{onInit:p,state:i(t),ref_key:"addRef",ref:d},null,8,["state"])])}}}),st=T(H,[["__scopeId","data-v-22d2f770"]]);export{st as default};
