import{d as V,g as E,a6 as B,r as T,b as M,o as b,c as x,a as i,w as d,f as s,e as f,u as r,aa as R,a8 as z,F as L,p as Y,t as _,y as P,k as U,z as j,h as G,i as H}from"./index-BF5jje68.js";import{v as J}from"./el-loading-DNd19Xuc.js";import{_ as K}from"./Add-Dow2Ues2.js";/* empty css                        *//* empty css                    */import{_ as O}from"./AaTitle.vue_vue_type_script_setup_true_lang-msvlqApB.js";import{_ as Q}from"./filter-BWaskIWj.js";import{a as W,E as X}from"./index-fed1VsgQ.js";/* empty css                    */import"./index-CU8Q0z-M.js";import"./Upload-DGrHTtFE.js";/* empty css                   */import"./index-CND7x1jx.js";import"./el-text-CBvW04Pe.js";import"./index-VYQ43fvS.js";const Z={class:"layout-col"},ee={class:"flex-sc mr15"},te={class:"w50x6 flex-sc"},ae={class:"layout-col white-rgba50 rad8 p15"},se={class:"ww100 flex-sc p8 mb15"},re={class:"flex-sc fw f16 tc"},ie=["onClick"],le={class:"mb5"},ne={class:"layout-col"},oe=["onClick"],Ce=V({__name:"index",setup(de){const{proxy:m}=E(),y=m.publicStore(),c=m.configStore(),A=B();let w=H();const $=[{value:"1",name:"不达标"},{value:"2",name:"不足"},{value:"3",name:"达标"},{value:"4",name:"一般"},{value:"5",name:"较好"},{value:"6",name:"很好"}],C=[{value:"1",name:"预期指标"},{value:"2",name:"底线指标"}],e=T({...y.$state,editFrom:[{required:!0,editshow:!0,name:"选择指标",key:"parent_id",type:"select",list:[],value:"id",label:"name"},{required:!0,editshow:!0,name:"指标类别",key:"class",type:"select",list:C,value:"value",label:"name"},{required:!0,editshow:!0,name:"上年指标值",key:"pre_year",type:"input",class:"number",regex:["^(100000|[1-9]\\d{0,4}|0)$","请输入0~100000"]},{required:!0,editshow:!0,name:"本年指标值",key:"nex_year",type:"input",class:"number",regex:["^(100000|[1-9]\\d{0,4}|0)$","请输入0~100000"]},{required:!0,editshow:!0,name:"评价",key:"res",type:"select",list:$,value:"value",label:"name"}],model:"t_scheme_problem_result"}),F=l=>parseInt(e.page)+l;M(async()=>{e.active={...A.query},await q(),v()});const q=async()=>{let l={model:"t_problem_type",args:`parent_id='${e.active.parent_id}'`,order:"orderd ASC"},a=await y.http({Api:l});e.actives=m.isNull(a)?[]:a.sort((u,o)=>u.orderd-o.orderd)},v=async l=>{N();let a={model:"t_task_problem",args:`parent_id='${e.active.id}'`,order:"orderd ASC"},u={model:"t_scheme_problem_result",args:`scheme_id='${e.active.scheme_id}' and parents_id='${e.active.id}'`};if(!m.isNull(e.datetime)){const[g,n]=e.datetime,k=new Date(g.getFullYear(),0,1).getTime()+"",h=new Date(n.getFullYear(),11,31,23,59,59,999).getTime()+"";u.args+=` and check_time>='${k}' and check_time<='${h}'`}let o=await y.http({Api1:a,Api2:u});e.task_problems=m.isNull(o.Api1)?[]:o.Api1,e.editFrom[0].list=[...o.Api1],e.list=m.isNull(o.Api2)?[]:o.Api2},N=()=>{e.addItem={check_year:"2026",check_time:"1770048252885",scheme_id:e.active.scheme_id,parents_id:e.active.id,user_id:c.user.id,user_name:c.user.name,province:c.user.province,province_name:c.user.province_name,city:c.user.city,city_name:c.user.city_name,district:c.user.district,district_name:c.user.district_name}},D=(l,a)=>{w.value.del(a)};return(l,a)=>{const u=z,o=Q,g=O,n=W,k=X,h=K,I=J;return b(),x("div",Z,[i(g,{title:""},{"left-content":d(()=>[s("div",ee,[a[4]||(a[4]=s("span",{class:"mr10"},"体检年度",-1)),s("span",te,[i(u,{class:"",style:{width:"100%"},modelValue:r(e).datetime,"onUpdate:modelValue":a[0]||(a[0]=t=>r(e).datetime=t),type:"yearrange","range-separator":"-","start-placeholder":"请选择年度","end-placeholder":"请选择年度"},null,8,["modelValue"])])]),s("div",{class:"rad4 ptb6 plr12 flex-cc cursor bgi1 white",onClick:a[1]||(a[1]=f(t=>v(),["stop"]))},[i(o,{class:"f12 fw"}),a[5]||(a[5]=s("span",{class:"f14 ml5"},"搜索",-1))])]),"right-content":d(()=>[s("div",{class:"rad4 ptb6 plr12 flex-cc cursor bo-i1-1 i1 ml15",onClick:a[2]||(a[2]=f(t=>r(w).onVisable(r(e).addItem),["stop"]))},[...a[6]||(a[6]=[s("span",{class:"f14 ml5"},"新增",-1)])]),s("div",{class:"rad4 ptb6 plr12 flex-cc cursor bo-i1-1 i1 ml15",onClick:a[3]||(a[3]=f(t=>r(R).back(),["stop"]))},[...a[7]||(a[7]=[s("span",{class:"f14 ml5"},"返回",-1)])])]),_:1}),s("div",ae,[s("div",se,[s("div",re,[(b(!0),x(L,null,Y(r(e).actives?r(e).actives:[],(t,p)=>(b(),x("div",{class:"mr20 cursor flex-col-cc",key:p,onClick:f(S=>{r(e).active.id=t.id,r(e).page=1,v()},["stop"])},[s("span",le,_(t.name),1),s("span",{class:P(["ww100 h3 rad10",t.id==r(e).active.id?"bgi2":"black-rgba0"])},null,2)],8,ie))),128))])]),s("div",ne,[l.isNull(r(e).list)?G("",!0):U((b(),j(k,{key:0,"header-cell-class-name":"bgi16 c3","cell-style":{"background-color":"#FFFFFF",color:"#626366"},border:"","empty-text":"暂无数据",data:r(e).list,stripe:""},{default:d(()=>[i(n,{type:"index",index:F,label:"序号",align:"center",width:"50"}),i(n,{label:"指标名称"},{default:d((t,p)=>[s("span",null,_(t.row.parent_id?l.find(r(e).task_problems,["id",t.row.parent_id],"name"):""),1)]),_:1}),i(n,{label:"指标类别",width:"170",align:"center"},{default:d((t,p)=>[s("span",null,_(t.row.class?l.find(C,["value",t.row.class],"name"):""),1)]),_:1}),i(n,{label:"所属维度",width:"170",align:"center"},{default:d((t,p)=>[s("span",null,_(t.row.parent_id?l.find(r(e).task_problems,["id",t.row.parent_id],"type"):""),1)]),_:1}),i(n,{label:"指标单位",width:"170",align:"center"},{default:d((t,p)=>[s("span",null,_(t.row.parent_id?l.find(r(e).task_problems,["id",t.row.parent_id],"unit"):""),1)]),_:1}),i(n,{prop:"pre_year",label:"上年指标值",width:"170",align:"center"}),i(n,{prop:"nex_year",label:"本年指标值",width:"170",align:"center"}),i(n,{label:"评价结果",align:"center",width:"170"},{default:d((t,p)=>[s("span",null,_(t.row.res?l.find($,["value",t.row.res],"name"):""),1)]),_:1}),i(n,{label:"操作",align:"center",width:"55"},{default:d((t,p)=>[s("span",{class:"cursor i8",onClick:f(S=>D("del",t.row),["stop"])},"删除",8,oe)]),_:1})]),_:1},8,["data"])),[[I,r(e).loading,void 0,{fullscreen:!0,lock:!0}]])])]),i(h,{onInit:v,state:r(e),ref_key:"addRef",ref:w},null,8,["state"])])}}});export{Ce as default};
