import{_ as v}from"./Add-D2-IK3J2.js";import{_ as x}from"./ListTree.vue_vue_type_script_setup_true_lang-BhlmFfwH.js";import{_ as C}from"./AbTitle.vue_vue_type_script_setup_true_lang-DyGHzfWV.js";import{d as V,g as j,r as q,b as I,A as R,n as S,o as f,c as y,a as p,w as T,u as a,e as $,_ as A,f as m,t as B,h as O,i as h}from"./index-ClTGGYJq.js";const D={class:"layout-col flex1"},E={class:"f14 ml2"},H={class:"layout-col bg-white"},G=V({__name:"m1",setup(M){const{proxy:s}=j(),l=s.publicStore();s.configStore(),s.dictStore();let i=h(),u=h();const e=q({...l.$state,listRow:!0,listExpand:!0,content:[{width:"flex1",show:!0,align:"left",key:"name",name:"名称",type:"icon5"},{width:"w50x3",show:!0,align:"right",key:{add:"添加",upd:"编辑",del:"删除"},name:"操作"}],editFrom:[{required:!0,editshow:"none",name:"上级",key:"parent_id",type:"input"},{required:!0,editshow:!0,name:"名称",key:"name",type:"input"},{required:!1,editshow:!0,name:"排序",key:"order",type:"input"}],addItem:{parent_id:"0",type:0}});I(async()=>{await k(),_()});const k=async()=>{let n=await R.get("./china/100000.json");l._public.provinces=n.data.features.map(t=>t.properties)},_=async n=>{e.query={model:e.model,args:"type=0"},e.params={Api:e.query};let t=await l.http(e.params);e.empty=!!s.isNull(t),e.list=s.isNull(t)?[]:t.sort((o,d)=>o.order-d.order),l._public.list=e.list,s.isNull(e.list)||w(n)},w=async n=>{e.tree=s.treeData(e.list,e.key,e.parent,"children");let t=s.findNode(e.tree,c=>!c.children),o=s.findNode(e.tree,c=>c[e.key]==n),d=s.isNull(o)?t:o;await S(),u.value.handleNodeClick(d)},b=async n=>{n.classify||(l.active=Object.assign({},n))},g=(n,t)=>{if(n=="add"){let o={parent_id:t.id,type:0};i.value.onVisable(o)}if(n=="upd"&&i.value.onVisable(t),n=="child"){let o=s.varObj(e.parent,t[e.key]);i.value.onVisable(o)}n=="del"&&i.value.del(t)};return(n,t)=>{const o=A,d=C,c=x,N=v;return f(),y("div",D,[p(d,{title:"行业"},{"right-content":T(()=>[a(e).content.find(r=>typeof r.key=="object")&&a(e).content.find(r=>typeof r.key=="object").key.hasOwnProperty("add")?(f(),y("div",{key:0,class:"rad4 ptb5 plr8 flex-cc cursor bgi1 white ml10",onClick:t[0]||(t[0]=$(r=>a(i).onVisable(a(e).addItem),["stop"]))},[p(o,{class:"f12 fw"}),m("span",E,B(a(e).content.find(r=>typeof r.key=="object").key.add),1)])):O("",!0)]),_:1}),m("div",H,[p(c,{onHandleNodeClick:b,onHandleClick:g,state:a(e),ref_key:"listTreeRef",ref:u},null,8,["state"])]),p(N,{onInit:_,state:a(e),ref_key:"addRef",ref:i},null,8,["state"])])}}});export{G as _};
