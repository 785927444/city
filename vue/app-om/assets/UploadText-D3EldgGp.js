import{d as S,g as k,Y as b,o as l,z as x,u as c,w as z,c as u,t as w,aF as E,a4 as B,r as C,l as I}from"./index-Bd85TTIS.js";/* empty css                    *//* empty css                   */import{E as M}from"./index-DXutnob0.js";import{E as m}from"./index-DDNRsVXm.js";/* empty css                                                                   */const T={key:0},U={key:1},A=S({__name:"UploadText",props:E({action:{type:String,default:"/api/v1/terminal/base/uploadFile"},fileLimit:{type:Number,default:5},fileSize:{type:Number,default:50},fileType:{type:Array,default:[]},fileList:{type:[Array,String],default:[]}},{model:{},modelModifiers:{}}),emits:["update:model"],setup(r){const{proxy:p}=k();p.publicStore();const n=p.configStore(),o=b(r,"model"),d=r,i=C({dialogVisible:!1,dialogImageUrl:""}),f=t=>{i.dialogImageUrl=t.url,i.dialogVisible=!0},y=t=>{const e=t.size/1024/1024<d.fileSize;return e||m({type:"error",message:"上传图片大小不能超过 "+d.fileSize+"MB!"}),e},g=(t,e,a)=>{let s=e.response.data;s&&Object.prototype.hasOwnProperty.call(e,"response")&&e.response.data&&(o.value={data:s,name:e.name,time:e.uid,status:e.status,type:e.raw.type},console.log("data---",s),B({title:"提示",message:e.status=="success"?"上传成功":"上传失败",type:e.status=="success"?"success":"error"}))},_=(t,e)=>{if(!t||!Object.prototype.hasOwnProperty.call(t,"response"))return;let a=t.response.data,s=o.value.findIndex(h=>h==a);s!=-1&&o.value.splice(s,1)},v=()=>{i.loading=!1,m({type:"error",message:"上传失败"})};return(t,e)=>{const a=M;return l(),x(a,{class:"avatar-uploader","show-file-list":!1,action:r.action,headers:{Authorization:c(n).token,"X-CSRF-Token":c(n).csrfToken,AuthToken:"xyz"+t.encrypt("xyz"+c(n).secret_key)},"before-upload":y,"on-success":g,"on-error":v,"on-remove":_,"on-preview":f},{default:z(()=>[o.value?(l(),u("span",T,w(o.value.name?o.value.name:"未知"),1)):(l(),u("span",U,"点击上传"))]),_:1},8,["action","headers"])}}}),R=I(A,[["__scopeId","data-v-dfa15af5"]]);export{R as _};
