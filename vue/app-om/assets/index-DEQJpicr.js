import{_ as M}from"./Pagination.vue_vue_type_style_index_0_lang-BA7bW-pp.js";import{_ as j}from"./check-CqQe_O-a.js";import{_ as D}from"./AaTitle.vue_vue_type_script_setup_true_lang-BnIAtUUF.js";import{_ as z}from"./filter-73tbkGYd.js";import{d as F,g as L,a6 as H,r as K,b as G,o,c as m,a as f,w as v,f as l,e as y,a8 as J,u as a,m as Q,F as h,p as x,z as $,q as W,E as X,t as p,h as S,y as I,k as Z,v as tt,a9 as et,a4 as q,l as st}from"./index-C0LFq0t5.js";import"./el-pagination-BB8JCOIr.js";const lt={class:"layout-col"},at={class:"flex-sc mr30"},nt={class:"w50x4"},it={class:"flex-sc mr30"},ot={class:"w50x3"},ct={class:"flex-sc mr30"},rt={class:"w50x3"},pt={class:"flex-sc mr15"},dt={class:"w50x3"},ut={class:"flex-sc mr15"},mt={class:"w50x3"},_t={class:"layout-col bg-white rad8 p8"},ft={class:"ww100 flex-sc p8"},yt={class:"flex-sc fw f16 tc"},wt=["onClick"],gt={key:0,class:"w20 h20 rad2 lh20 tc bgi13 i15 b20 l50 absolute"},bt={class:"mb5"},kt={class:"flex-ec flex1"},vt={class:"table flex-sc warp"},ht={class:"ww100 bs bo-i16-1 relative rad8"},xt={class:"ww100 flex-sc p12 bob-ce-1"},$t={class:"f15"},Ct={class:"flex1 flex-ec"},At=["onClick"],Nt={class:"ww100 flex-col p12 c6"},Vt={class:"ww100 flex-sc"},Ut={class:"ww100 flex-sc mt10"},Et={class:"ww100 flex-sc mt10"},St={class:"ww100 flex-sc mt10"},It={class:"ww100 flex-sc mt10"},qt={class:"ww100 flex-sc mt10"},Ot={class:"ww100 flex-sc mt10"},Tt={class:"flex-sc flex1"},Rt=["onClick"],Yt=F({__name:"index",setup(Bt){const{proxy:c}=L(),k=c.publicStore(),w=c.configStore(),O=c.dictStore();H();const s=K({...k.$state,click:!1,clickArr:[],provinces:[],province:"",citys:[],city:"",types:[{type:"actionRelease",name:"已上报",path:"/actionRelease"},{type:"actionRelease1",name:"已申请",path:"/actionRelease1"},{type:"actionRelease2",name:"已退回",path:"/actionRelease2"}],type:"actionRelease1",completion_status:"1",search:"",schemeAreas:[{value:"1",name:"龙城片区"}]});G(async()=>{await T(),C()});const T=async()=>{s.provinces=[{name:w.user.province_name,value:w.user.province}],s.province=s.provinces[0].value;let i=w.user.parent_id=="0"?{model:"t_station",args:`parent_id='${w.user.station_num}'`}:{model:"t_station",args:`id='${w.user.station_num}'`},t=await k.http({Api:i}),g=c.isNull(t)?[]:t.sort((n,b)=>n.order-b.order);s.citys=g.map(n=>({name:n.station_name,value:n.city})),!c.isNull(s.citys)&&w.user.parent_id!="0"&&(s.city=s.citys[0].value)},C=async i=>{let t="t_project_report",g="apply_status = '1' and reserve_status ='0'",n="apply_status = '0' and reserve_status ='0'",b="apply_status = '3' and reserve_status ='0'",d={model:t,args:g},A={model:t,field:"COUNT(*)",args:n},N={model:t,field:"COUNT(*)",args:b};if(R(A),Y(N),s.province){if(d.args+=` and province='${s.province}'`,s.city&&(d.args+=` and city='${s.city}'`),!c.isNull(s.construct_datetime)){const[r,P]=s.construct_datetime;d.args+=` and construct_datetime_start>='${r}' and construct_datetime_end<='${P}'`}s.completion_status&&(d.args+=` and completion_status='${s.completion_status}'`),s.search&&(d.args+=` and name LIKE '%${s.search}%'`)}let V={limit:s.limit,page:s.page},U={field:"COUNT(*)"},e={},u={};Object.assign(e,d,V),Object.assign(u,d,U);let _=await k.http({Api1:e,Api2:u});s.total=c.isNull(_.Api2)?0:_.Api2[0]["COUNT(*)"];let B=s.types.find(r=>r.type==s.type);B.total=s.total,s.empty=!!c.isNull(_.Api1),s.list=c.isNull(_.Api1)?[]:_.Api1,s.list.forEach(r=>{r.area=(r.province_name||"")+(r.city_name?`-${r.city_name}`:"")+(r.district_name?`-${r.district_name}`:"")})},R=i=>{k.http({Api:i}).then(t=>{s.types[0].total=c.isNull(t)?0:t[0]["COUNT(*)"]})},Y=i=>{k.http({Api:i}).then(t=>{s.types[2].total=c.isNull(t)?0:t[0]["COUNT(*)"]})},E=(i,t)=>{i=="remind"&&et.confirm("是否确定提醒?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{if(s.list.findIndex(n=>n.click)==-1)return q({title:"提示",message:"请选择至少一个",type:"error"});q({title:"提示",message:"提醒成功",type:"success"})}),i=="selectAll"&&(s.list.findIndex(n=>n.click)==-1?(s.click=!0,s.list.forEach(n=>{n.click=!0,s.clickArr.push(n)})):(s.click=!1,s.clickArr=[],s.list.forEach(n=>{delete n.click})))};return(i,t)=>{const g=J,n=W,b=Q,d=X,A=z,N=D,V=j,U=M;return o(),m("div",lt,[f(N,{title:""},{"left-content":v(()=>[l("div",at,[t[12]||(t[12]=l("span",{class:"mr10"},"项目周期",-1)),l("span",nt,[f(g,{style:{width:"100%"},modelValue:a(s).construct_datetime,"onUpdate:modelValue":t[0]||(t[0]=e=>a(s).construct_datetime=e),"start-placeholder":"开始周期","end-placeholder":"结束周期",type:"yearrange","value-format":"YYYY",format:"YYYY"},null,8,["modelValue"])])]),l("div",it,[t[13]||(t[13]=l("span",{class:"mr10"},"所属行政",-1)),l("span",ot,[f(b,{modelValue:a(s).province,"onUpdate:modelValue":t[1]||(t[1]=e=>a(s).province=e),placeholder:"请选择",style:{width:"100%"},filterable:""},{default:v(()=>[(o(!0),m(h,null,x(a(s).provinces,(e,u)=>(o(),$(n,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",ct,[t[14]||(t[14]=l("span",{class:"mr10"},"所属地市",-1)),l("span",rt,[f(b,{modelValue:a(s).city,"onUpdate:modelValue":t[2]||(t[2]=e=>a(s).city=e),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:a(w).user.parent_id=="0"},{default:v(()=>[(o(!0),m(h,null,x(a(s).citys,(e,u)=>(o(),$(n,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","clearable"])])]),l("div",pt,[t[15]||(t[15]=l("span",{class:"mr10"},"实施状态",-1)),l("span",dt,[f(b,{modelValue:a(s).completion_status,"onUpdate:modelValue":t[3]||(t[3]=e=>a(s).completion_status=e),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{default:v(()=>[(o(!0),m(h,null,x(a(O).project_completion_statuss,(e,u)=>(o(),$(n,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",ut,[t[16]||(t[16]=l("span",{class:"mr10"},"项目名称",-1)),l("span",mt,[f(d,{modelValue:a(s).search,"onUpdate:modelValue":t[4]||(t[4]=e=>a(s).search=e),style:{width:"100%"},placeholder:"请输入"},null,8,["modelValue"])])]),l("div",{class:"rad4 ptb6 plr12 flex-cc cursor bgi1 white",onClick:t[5]||(t[5]=y(e=>C(),["stop"]))},[f(A,{class:"f12 fw"}),t[17]||(t[17]=l("span",{class:"f14 ml5"},"搜索",-1))])]),"right-content":v(()=>[l("div",{class:"rad4 ptb6 plr12 flex-cc cursor ml15 bg-white c8 bo-cc-1",onClick:t[6]||(t[6]=y(e=>i.toPath("/actionApply"),["stop"]))},"新建项目"),l("div",{class:"rad4 ptb6 plr12 flex-cc cursor ml15 bgi1 white",onClick:t[7]||(t[7]=y(e=>i.toPath("/actionHome"),["stop"]))},"项目库")]),_:1}),l("div",_t,[l("div",ft,[l("div",yt,[(o(!0),m(h,null,x(a(s).types,(e,u)=>(o(),m("div",{class:"mr40 cursor flex-col-cc relative",key:u,onClick:y(_=>i.toPath(e.path),["stop"])},[e.total?(o(),m("span",gt,p(e.total),1)):S("",!0),l("span",bt,p(e.name),1),l("span",{class:I(["ww100 h3 rad10",e.type==a(s).type?"bgi2":"black-rgba0"])},null,2)],8,wt))),128))]),l("div",kt,[l("div",{class:"rad4 ptb5 plr12 flex-cc cursor bg-white c8 bo-cc-1 ml15",onClick:t[8]||(t[8]=y(e=>E("selectAll"),["stop"]))},"全选"),l("div",{class:"rad4 ptb5 plr12 flex-cc cursor bgi1 white bo-i1-1 ml15",onClick:t[9]||(t[9]=y(e=>E("remind"),["stop"]))},"提醒")])]),l("div",vt,[(o(!0),m(h,null,x(a(s).list,(e,u)=>(o(),m("div",{class:"ww25 cursor p8",key:u},[l("div",ht,[l("div",xt,[l("span",$t,p(e.name),1),l("span",Ct,[l("span",{class:I(["w18 h18 tc lh18 rad3 ml10 white f12",e.click?"bgi1 bo-i1-1":"bo-cc-1"]),onClick:y(_=>e.click=!e.click,["stop"])},[e.click?(o(),$(V,{key:0})):S("",!0)],10,At)])]),l("div",Nt,[l("div",Vt,[t[18]||(t[18]=l("span",{class:"w110"},"所属地区",-1)),l("span",null,p(e.area?e.area:""),1)]),l("div",Ut,[t[19]||(t[19]=l("span",{class:"w110"},"所属片区",-1)),l("span",null,p(e.parent_area?i.find(a(s).schemeAreas,["value",e.parent_area],"name"):"-"),1)]),l("div",Et,[t[20]||(t[20]=l("span",{class:"w110"},"项目周期",-1)),l("span",null,p(e.construct_datetime_start&&e.construct_datetime_end?`${e.construct_datetime_start}-${e.construct_datetime_end}`:"-"),1)]),l("div",St,[t[21]||(t[21]=l("span",{class:"w110"},"项目规模",-1)),l("span",null,p(e.construct_scale?`${e.construct_scale}`:"-"),1)]),l("div",It,[t[22]||(t[22]=l("span",{class:"w110"},"预估投入",-1)),l("span",null,p(e.construct_price?`${e.construct_price} 万元`:"-"),1)]),l("div",qt,[t[23]||(t[23]=l("span",{class:"w110"},"项目性质",-1)),l("span",null,p(e.construct_nature?i.decrypt(e.construct_nature):"-"),1)]),l("div",Ot,[l("div",Tt,[t[24]||(t[24]=l("span",{class:"w110"},"更新进度时间",-1)),l("span",null,p(e.update_time?i.parseTime(e.update_time):"-"),1)]),l("div",{class:"rad5 ptb5 plr12 cursor bgi1 white",onClick:y(_=>i.toPath("/actionApply",{id:e.id}),["stop"])},"更新项目",8,Rt)])])])]))),128))]),Z(f(U,{class:"",style:{"padding-bottom":"0"},total:a(s).total,page:a(s).page,"onUpdate:page":t[10]||(t[10]=e=>a(s).page=e),pageModifiers:{sync:!0},limit:a(s).limit,"onUpdate:limit":t[11]||(t[11]=e=>a(s).limit=e),limitModifiers:{sync:!0},onPagination:C},null,8,["total","page","limit"]),[[tt,a(s).total>0]])])])}}}),Lt=st(Yt,[["__scopeId","data-v-e483e497"]]);export{Lt as default};
