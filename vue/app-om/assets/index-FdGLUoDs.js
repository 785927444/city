import{d as $,g as w,r as j,ce as J,b as O,o as B,c as E,f as d,t as I,u as l,e as T,a as f,k as m,v as y,a6 as D,a9 as M}from"./index-Bd85TTIS.js";import{_ as C}from"./stepTitle.vue_vue_type_script_setup_true_lang-GnuLd7Mr.js";import{_ as F}from"./step3.vue_vue_type_script_setup_true_lang-aeSJRrL5.js";import L from"./step2-nO0OHL-I.js";import P from"./step1-BCs_QQgb.js";import"./FileList.vue_vue_type_script_setup_true_lang-CKvp74Rm.js";import"./ViewFiles-DMp3eGxU.js";import"./UploadText-D3EldgGp.js";/* empty css                    *//* empty css                   */import"./index-DXutnob0.js";import"./index-DDNRsVXm.js";/* empty css                                                                   *//* empty css                        *//* empty css                    */import"./index-CohXJBWb.js";import"./index-CLnax6KY.js";import"./List.vue_vue_type_script_setup_true_lang-DXXgUW06.js";import"./el-image-viewer-M0JIGJ1W.js";import"./el-switch-Cn5LjBBU.js";import"./select-CsfqV8e7.js";import"./question-filled-C0bg83Wx.js";import"./v6-B4YtUg27.js";import"./areaData-CfkeTXdx.js";import"./projects.vue_vue_type_script_setup_true_lang-ve3G8rtS.js";import"./el-loading-QtaFgzrj.js";import"./Pagination.vue_vue_type_style_index_0_lang-C7tlSLth.js";import"./el-pagination-BXrD03IN.js";import"./AaTitle.vue_vue_type_script_setup_true_lang-DNddMUg2.js";const V={class:"layout-col plr15"},R={class:"layout-col white-rgba50 rad8"},Y={class:"ww100 flex-bc f20 p15 mb20 bob-cd-1"},z={class:"fw"},G={class:"flex1 flex-ec"},H={class:"layout-col"},Ne=$({__name:"index",setup(K){const _=D(),{proxy:p}=w(),s=p.publicStore(),a=j({...s.$state});J(async()=>{s.actIndex=1,s.form={}}),O(async()=>{v()});const v=async i=>{let e={};const o=_.query&&String(_.query.demo)==="1";if(o){const t=Date.now();e={code:"TY-2026-0001",name:_.query?.name?String(_.query.name):"龙城片区旧城改造项目",level:"1",area:["140000","140100","140105"],parent_id:"1",parent_area:"1",construct_unit:"太原市城市更新中心",completion_status:"1",construct_main:"太原市住建局",construct_price:"12000",estimate_year:"2026",estimate_price:"2500",total_put_price:"5600",total_completion_price:"3200",estimated_start_time:"2025-12-12",estimated_end_time:"2028-12-30",stage:"1",total_income_price:"8000",task_type:"1",task_class:"1",construct_content:"1",construct_note:"以旧换新示范区改造",response_person:"王伟",contact_person:"张敏",contact_phone:"13800001234",vast_scheme:"新型城镇化",industrial_policy:"城市更新行动",gc_investmentd_irection:"民生改善",qu_stage_objective:"2028年前完成片区更新",mapdata:"龙城片区主干道及周边",plan_name:"龙城片区更新实施方案",plan_unit:"太原市城市更新中心",approval_time:"2026-01-15",plan_abstract:"围绕旧城片区综合更新，完善道路与公共配套",condition:"基础设施老旧，公共服务配套不足",fund_source:{value1:"3000",value2:"1200",value3:"800",value4:"600",value5:"400",value6:"900",value7:"500",value8:"200",value9:"300",value10:"100"},orther_text:{value1:"1",value2:"1",value3:"1",value4:"0",value5:"1",value6:"0",value7:"1",value8:"0",value9:"1",value10:"0",value11:"1",value12:"0",value13:"1",value14:"0",value15:"1"},attr:{value1:{status:"success",type:"基础资料",time:t,name:"33fa95f0152e4543912b88c636b26f9f.pdf",data:"/static/uploads/33fa95f0152e4543912b88c636b26f9f.pdf"},value2:{status:"success",type:"区位图",time:t,name:"879d409c37f94ed8bf5ad09fcb0240b7.png",data:"/static/uploads/879d409c37f94ed8bf5ad09fcb0240b7.png"}},plan_attr:{value1:{status:"success",type:"实施方案正文",time:t,name:"4eaa30b8a7ab40a798cf5b98924fde30.pdf",data:"/static/uploads/4eaa30b8a7ab40a798cf5b98924fde30.pdf"},value2:{status:"success",type:"实施方案附件",time:t,name:"3fe8234a9a194f0c9da7f477accfe2ec.docx",data:"/static/uploads/3fe8234a9a194f0c9da7f477accfe2ec.docx"}},task:[{id:"demo-task-1",task_type:"1",task_class:"道路改造",construct_content:"主干道提升",year:"2026",value:"3"},{id:"demo-task-2",task_type:"2",task_class:"环境整治",construct_content:"雨污分流",year:"2027",value:"2"}],project_status:"实施中",invested_amount:"3500",constructed_scale:"道路提升8公里、雨污分流12公里",implementation_effect:"已完成主干道拓宽与雨污分流一期建设，居民出行效率显著提升。",progress_tasks:[{id:"progress-1",task_type:"1",task_name:"城市更新示范片区建设",construction_content:"老旧片区基础设施提升",project_goal:"完善交通与公共配套",completed_goal:"完成主干道拓宽"},{id:"progress-2",task_type:"1",task_name:"雨污分流改造",construction_content:"管网改造与错接改正",project_goal:"改善排水系统",completed_goal:"完成一期改造"},{id:"progress-3",task_type:"2",task_name:"体检整改任务A",construction_content:"违建整治与环境提升",project_goal:"改善人居环境",completed_goal:"完成整改方案"}],process_files:{process_file:{status:"success",type:"过程材料",time:t,name:"c9115ee8414a4d1c82f2ca0462ec4e28.pdf",data:"/static/uploads/c9115ee8414a4d1c82f2ca0462ec4e28.pdf"}},effect_files:{effect_file:{status:"success",type:"实施成效",time:t,name:"f6931994aa2a4e1194c5192f14aba60b.pdf",data:"/static/uploads/f6931994aa2a4e1194c5192f14aba60b.pdf"}},approval_opinion:"进度更新信息齐全，建议继续推进。"}}else if(_.query&&_.query.id){let t={model:"t_project_report",args:`id='${_.query.id}'`},c=await s.http({Api:t});e=p.isNull(c)?{}:{...c[0]}}if(e.area){if(typeof e.area=="string")try{e.area=JSON.parse(e.area)}catch(t){console.error("解析失败:",t.message)}}else e.area=[];if(e.fund_source){if(typeof e.fund_source=="string")try{e.fund_source=JSON.parse(e.fund_source)}catch(t){console.error("解析失败:",t.message)}}else e.fund_source={value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",value7:"",value8:"",value9:"",value10:""};if(e.orther_text){if(typeof e.orther_text=="string")try{e.orther_text=JSON.parse(e.orther_text)}catch(t){console.error("解析失败:",t.message)}}else e.orther_text={value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",value7:"",value8:"",value9:"",value10:"",value11:"",value12:"",value13:"",value14:"",value15:""};if(e.attr){if(typeof e.attr=="string")try{e.attr=JSON.parse(e.attr)}catch(t){console.error("解析失败:",t.message)}}else e.attr={};if(e.plan_attr){if(typeof e.plan_attr=="string")try{e.plan_attr=JSON.parse(e.plan_attr)}catch(t){console.error("解析失败:",t.message)}}else e.plan_attr={};e.process_files||(e.process_files={}),e.effect_files||(e.effect_files={}),e.progress_tasks||(e.progress_tasks=[]),e.project_status||(e.project_status=""),e.invested_amount||(e.invested_amount=""),e.constructed_scale||(e.constructed_scale=""),e.implementation_effect||(e.implementation_effect=""),e.approval_opinion||(e.approval_opinion=""),s.form={...e},s._public.form=JSON.parse(JSON.stringify(e)),b(),g(),h(),k(),x(),o&&((!a.contents1||a.contents1.length===0)&&(a.contents1=[{id:"demo-base-1",parent_id:"demo-base",name:"基础资料",type:"value1"},{id:"demo-base-2",parent_id:"demo-base",name:"区位图",type:"value2"}],s._public.contents1=a.contents1,a.active1={id:"demo-base",name:"基础资料"}),(!a.contents2||a.contents2.length===0)&&(a.contents2=[{id:"demo-plan-1",parent_id:"demo-plan",name:"实施方案正文",type:"value1"},{id:"demo-plan-2",parent_id:"demo-plan",name:"实施方案附件",type:"value2"}],s._public.contents2=a.contents2,a.active2={id:"demo-plan",name:"实施方案"}))},b=async()=>{let i={model:"t_scheme_plan",args:"release_status='1'",field:"id, name"};s.http({Api:i}).then(e=>{s._public.schemePlans=p.isNull(e)?[]:e})},g=async()=>{s._public.schemeAreas=[{id:"1",name:"龙城片区"}]},h=async()=>{let i={model:"t_task_type"},e={model:"t_task_content"};s.http({Api1:i,Api2:e}).then(o=>{p.isNull(o.Api1)||o.Api1;let t=p.isNull(o.Api2)?[]:o.Api2;const c=o.Api1.filter(r=>r.parent_id==="0").map(r=>r.id),n=o.Api1.filter(r=>c.includes(r.parent_id)),u=o.Api1.filter(r=>n.map(S=>S.id).includes(r.parent_id));s._public.task_types=n,s._public.task_classs=u,s._public.construct_contents=t})},k=async()=>{let i={model:"t_scheme_task",args:`scheme_id='${s.form.scheme_id}'`};s.http({Api:i}).then(e=>{let o=p.isNull(e)?[]:e;s.form.tasks=[...e],s._public.tasks=JSON.parse(JSON.stringify(o))})},x=async()=>{let i={model:"t_file_type"},e={model:"t_file_content"},o=await s.http({Api1:i,Api2:e}),t=p.isNull(o.Api1)?[]:o.Api1.sort((n,u)=>n.orderd-u.orderd),c=p.isNull(o.Api2)?[]:o.Api2.sort((n,u)=>n.orderd-u.orderd);A(t,c,"019c2c63-cf59-719f-b942-7c7bb535413d"),N(t,c,"019c2cc4-d276-7805-9685-7a5dde449721")},A=(i,e,o)=>{let t=i.find(c=>c.id==o);if(t){let c=[];a.plans=i.filter(n=>n.parent_id==o),a.plans.forEach(n=>{n.parent_type=`${t.type}/${n.type}`;let u=e.filter(r=>r.parent_id==n.id);p.isNull(u)||u.forEach(r=>{r.parent_type=`${n.parent_type}/${r.type}`,c.push(r)})}),a.contents1=c,s._public.contents1=c,a.active1=p.isNull(a.plans)?{}:{...a.plans[0]}}},N=(i,e,o)=>{let t=i.find(c=>c.id==o);if(t){let c=[];a.plans=i.filter(n=>n.parent_id==o),a.plans.forEach(n=>{n.parent_type=`${t.type}/${n.type}`;let u=e.filter(r=>r.parent_id==n.id);p.isNull(u)||u.forEach(r=>{r.parent_type=`${n.parent_type}/${r.type}`,c.push(r)})}),a.contents2=c,s._public.contents2=c,a.active2=p.isNull(a.plans)?{}:{...a.plans[0]}}},q=()=>{let i=s.form.id?"正在编辑中,是否确定退出?":"正在编辑中,信息未保存是否确定退出?";M.confirm(i,"温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{p.toPath("/project-push")})};return(i,e)=>(B(),E("div",V,[d("div",R,[d("div",Y,[d("div",z,I(l(_).query&&l(_).query.id?"创建项目":"信息补充"),1),d("div",G,[d("div",{class:"plr14 ptb5 rad4 mr15 cursor c9 bg-white bo-c9-1",onClick:e[0]||(e[0]=T(o=>q(),["stop"]))},"返 回")])]),d("div",H,[f(l(C)),m(f(P,{state:l(a),contents:l(a).contents1,active:l(a).active1},null,8,["state","contents","active"]),[[y,l(s).actIndex==1]]),m(f(l(L),{state:l(a),contents:l(a).contents2,active:l(a).active2},null,8,["state","contents","active"]),[[y,l(s).actIndex==2]]),m(f(l(F),null,null,512),[[y,l(s).actIndex==3]])])])]))}});export{Ne as default};
