import{d as w,a6 as $,g as J,r as O,ce as B,b as D,o as E,c as T,f as d,t as I,u as p,e as M,a as m,k as f,v as y,a9 as C}from"./index-ClTGGYJq.js";import{_ as F}from"./stepTitle.vue_vue_type_script_setup_true_lang-iJe3Jaxs.js";import L from"./step1-PGlvArmD.js";import P from"./step2-CdgQo0vE.js";import"./FileList.vue_vue_type_script_setup_true_lang-Bn2Vhi25.js";import"./ViewFiles-BGc_2hC6.js";import"./UploadText-Czi9cq55.js";/* empty css                    *//* empty css                   */import"./index-BewEhLyo.js";import"./index-DIHLlVQH.js";/* empty css                                                                   *//* empty css                    */import"./areaData-CfkeTXdx.js";import"./projects.vue_vue_type_script_setup_true_lang-EVIR8kEU.js";import"./el-loading-WYLhAgbb.js";import"./Pagination.vue_vue_type_style_index_0_lang-u8YgO5nZ.js";import"./el-pagination-B7EgBbn6.js";/* empty css                        */import"./AaTitle.vue_vue_type_script_setup_true_lang-DQZ6AruM.js";import"./index-G0MRvna3.js";import"./index-CcHJUmzw.js";import"./SchemeAutoFill.vue_vue_type_script_setup_true_lang-BoB9I4Xx.js";import"./v6-B4YtUg27.js";import"./List.vue_vue_type_script_setup_true_lang-GWlOrLxS.js";import"./el-image-viewer-BSQBUEyb.js";import"./el-switch-C5epoo5P.js";import"./select-CebIyQvO.js";import"./question-filled-DXo9CDBC.js";const j={class:"layout-col plr15"},R={class:"layout-col white-rgba50 rad8"},V={class:"ww100 flex-bc f20 p15 mb20 bob-cd-1"},Y={class:"fw"},z={class:"flex1 flex-ec"},G={class:"layout-col"},At=w({__name:"index",setup(H){const _=$(),{proxy:c}=J(),a=c.publicStore();c.configStore();const n=O({...a.$state});B(async()=>{a.actIndex=1,a.form={}}),D(async()=>{v()});const v=async l=>{let t={};if(_.query&&String(_.query.demo)==="1"){const e=Date.now();t={code:"TY-2026-0001",name:_.query?.name?String(_.query.name):"龙城片区旧城改造项目",level:"1",area:["140000","140100","140105"],parent_id:"1",parent_area:"1",construct_unit:"太原市城市更新中心",completion_status:"1",construct_main:"太原市住建局",construct_price:"12000",estimate_year:"2026",estimate_price:"2500",total_put_price:"5600",total_completion_price:"3200",estimated_start_time:"2025-12-12",estimated_end_time:"2028-12-30",stage:"1",total_income_price:"8000",task_type:"1",task_class:"1",construct_content:"1",construct_note:"以旧换新示范区改造",response_person:"王伟",contact_person:"张敏",contact_phone:"13800001234",vast_scheme:"新型城镇化",industrial_policy:"城市更新行动",gc_investmentd_irection:"民生改善",qu_stage_objective:"2028年前完成片区更新",mapdata:"龙城片区主干道及周边",plan_name:"龙城片区更新实施方案",plan_unit:"太原市城市更新中心",approval_time:"2026-01-15",plan_abstract:"围绕旧城片区综合更新，完善道路与公共配套",condition:"基础设施老旧，公共服务配套不足",fund_source:{value1:"3000",value2:"1200",value3:"800",value4:"600",value5:"400",value6:"900",value7:"500",value8:"200",value9:"300",value10:"100"},orther_text:{value1:"1",value2:"1",value3:"1",value4:"0",value5:"1",value6:"0",value7:"1",value8:"0",value9:"1",value10:"0",value11:"1",value12:"0",value13:"1",value14:"0",value15:"1"},attr:{value1:{status:"success",type:"基础条件",time:e,name:"基础条件.pdf",data:"/uploads/demo/基础条件.pdf"}},plan_attr:{value1:{status:"success",type:"实施方案",time:e,name:"实施方案.pdf",data:"/uploads/demo/实施方案.pdf"}},task:[{id:"demo-task-1",task_type:"1",task_class:"道路改造",construct_content:"主干道提升",year:"2026",value:"3"},{id:"demo-task-2",task_type:"2",task_class:"环境整治",construct_content:"雨污分流",year:"2027",value:"2"}]}}else if(_.query&&_.query.id){let e={model:"t_project_report",args:`id='${_.query.id}'`},o=await a.http({Api:e});t=c.isNull(o)?{}:{...o[0]}}if(t.area){if(typeof t.area=="string")try{t.area=JSON.parse(t.area)}catch(e){console.error("解析失败:",e.message)}}else t.area=[];if(t.fund_source){if(typeof t.fund_source=="string")try{t.fund_source=JSON.parse(t.fund_source)}catch(e){console.error("解析失败:",e.message)}}else t.fund_source={value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",value7:"",value8:"",value9:"",value10:""};if(t.orther_text){if(typeof t.orther_text=="string")try{t.orther_text=JSON.parse(t.orther_text)}catch(e){console.error("解析失败:",e.message)}}else t.orther_text={value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",value7:"",value8:"",value9:"",value10:"",value11:"",value12:"",value13:"",value14:"",value15:""};if(t.attr){if(typeof t.attr=="string")try{t.attr=JSON.parse(t.attr)}catch(e){console.error("解析失败:",e.message)}}else t.attr={};if(t.plan_attr){if(typeof t.plan_attr=="string")try{t.plan_attr=JSON.parse(t.plan_attr)}catch(e){console.error("解析失败:",e.message)}}else t.plan_attr={};a.form={...t},a._public.form=JSON.parse(JSON.stringify(t)),h(),g(),b(),k(),N()},h=async()=>{let l={model:"t_scheme_plan",args:"release_status='1'",field:"id, name"};a.http({Api:l}).then(t=>{a._public.schemePlans=c.isNull(t)?[]:t})},g=async()=>{a._public.schemeAreas=[{id:"1",name:"龙城片区"}]},b=async()=>{let l={model:"t_task_type"},t={model:"t_task_content"};a.http({Api1:l,Api2:t}).then(s=>{c.isNull(s.Api1)||s.Api1;let e=c.isNull(s.Api2)?[]:s.Api2;const o=s.Api1.filter(i=>i.parent_id==="0").map(i=>i.id),r=s.Api1.filter(i=>o.includes(i.parent_id)),u=s.Api1.filter(i=>r.map(S=>S.id).includes(i.parent_id));a._public.task_types=r,a._public.task_classs=u,a._public.construct_contents=e})},k=async()=>{let l={model:"t_scheme_task",args:`scheme_id='${a.form.scheme_id}'`};a.http({Api:l}).then(t=>{let s=c.isNull(t)?[]:t;a.form.tasks=[...t],a._public.tasks=JSON.parse(JSON.stringify(s))})},N=async()=>{let l={model:"t_file_type"},t={model:"t_file_content"},s=await a.http({Api1:l,Api2:t}),e=c.isNull(s.Api1)?[]:s.Api1.sort((r,u)=>r.orderd-u.orderd),o=c.isNull(s.Api2)?[]:s.Api2.sort((r,u)=>r.orderd-u.orderd);A(e,o,"019c2c63-cf59-719f-b942-7c7bb535413d"),x(e,o,"019c2cc4-d276-7805-9685-7a5dde449721")},A=(l,t,s)=>{let e=l.find(o=>o.id==s);if(e){let o=[];n.plans=l.filter(r=>r.parent_id==s),n.plans.forEach(r=>{r.parent_type=`${e.type}/${r.type}`;let u=t.filter(i=>i.parent_id==r.id);c.isNull(u)||u.forEach(i=>{i.parent_type=`${r.parent_type}/${i.type}`,o.push(i)})}),n.contents1=o,a._public.contents1=o,n.active1=c.isNull(n.plans)?{}:{...n.plans[0]}}},x=(l,t,s)=>{let e=l.find(o=>o.id==s);if(e){let o=[];n.plans=l.filter(r=>r.parent_id==s),n.plans.forEach(r=>{r.parent_type=`${e.type}/${r.type}`;let u=t.filter(i=>i.parent_id==r.id);c.isNull(u)||u.forEach(i=>{i.parent_type=`${r.parent_type}/${i.type}`,o.push(i)})}),n.contents2=o,a._public.contents2=o,n.active2=c.isNull(n.plans)?{}:{...n.plans[0]}}},q=()=>{let l=a.form.id?"正在编辑中,是否确定退出?":"正在编辑中,信息未保存是否确定退出?";C.confirm(l,"温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{c.toPath("/actionRelease")})};return(l,t)=>(E(),T("div",j,[d("div",R,[d("div",V,[d("div",Y,I(p(_).query&&p(_).query.id?"创建项目":"信息补充"),1),d("div",z,[d("div",{class:"plr14 ptb5 rad4 mr15 cursor c9 bg-white bo-c9-1",onClick:t[0]||(t[0]=M(s=>q(),["stop"]))},"返 回")])]),d("div",G,[m(p(F)),f(m(p(L),{state:p(n),contents:p(n).contents1,active:p(n).active1},null,8,["state","contents","active"]),[[y,p(a).actIndex==1]]),f(m(p(P),{state:p(n),contents:p(n).contents2,active:p(n).active2},null,8,["state","contents","active"]),[[y,p(a).actIndex==2]])])])]))}});export{At as default};
