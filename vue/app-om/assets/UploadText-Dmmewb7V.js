import{d as S,g as b,Y as k,o as l,z as x,w as z,c as d,t as w,u as c,bc as E,a4 as B,r as C,l as I}from"./index-CymMRwSV.js";import{E as M}from"./el-progress-BEBGOLgq.js";import{E as m}from"./el-message-BtiibD_d.js";const T={key:0},U={key:1},A=S({__name:"UploadText",props:E({action:{type:String,default:"/api/v1/terminal/base/uploadFile"},fileLimit:{type:Number,default:5},fileSize:{type:Number,default:50},fileType:{type:Array,default:[]},fileList:{type:[Array,String],default:[]}},{model:{},modelModifiers:{}}),emits:["update:model"],setup(r){const{proxy:p}=b();p.publicStore();const n=p.configStore(),s=k(r,"model"),u=r,i=C({dialogVisible:!1,dialogImageUrl:""}),f=t=>{i.dialogImageUrl=t.url,i.dialogVisible=!0},y=t=>{const e=t.size/1024/1024<u.fileSize;return e||m({type:"error",message:"上传图片大小不能超过 "+u.fileSize+"MB!"}),e},g=(t,e,o)=>{let a=e.response.data;a&&Object.prototype.hasOwnProperty.call(e,"response")&&e.response.data&&(s.value={data:a,name:e.name,time:e.uid,status:e.status,type:e.raw.type},B({title:"提示",message:e.status=="success"?"上传成功":"上传失败",type:e.status=="success"?"success":"error"}))},_=(t,e)=>{if(!t||!Object.prototype.hasOwnProperty.call(t,"response"))return;let o=t.response.data,a=s.value.findIndex(h=>h==o);a!=-1&&s.value.splice(a,1)},v=()=>{i.loading=!1,m({type:"error",message:"上传失败"})};return(t,e)=>{const o=M;return l(),x(o,{class:"avatar-uploader","show-file-list":!1,action:r.action,headers:{Authorization:c(n).token,"X-CSRF-Token":c(n).csrfToken,AuthToken:"xyz"+t.encrypt("xyz"+c(n).secret_key)},"before-upload":y,"on-success":g,"on-error":v,"on-remove":_,"on-preview":f},{default:z(()=>[s.value?(l(),d("span",T,w(s.value.name?s.value.name:"未知"),1)):(l(),d("span",U,"点击上传"))]),_:1},8,["action","headers"])}}}),N=I(A,[["__scopeId","data-v-92a2d321"]]);export{N as _};
