import{F as w}from"./FileSaver.min-KAuW4yPw.js";import{u as b,w as y,S as l}from"./xlsx-CaORBL06.js";import"./index-BF5jje68.js";function A(a){for(var i=[],s=a.querySelectorAll("tr"),e=[],r=0;r<s.length;++r){for(var t=[],n=s[r],v=n.querySelectorAll("td"),c=0;c<v.length;++c){var g=v[c],p=g.getAttribute("colspan"),f=g.getAttribute("rowspan"),h=g.innerText;if(h!==""&&h==+h&&(h=+h),e.forEach(function(o){if(r>=o.s.r&&r<=o.e.r&&t.length>=o.s.c&&t.length<=o.e.c)for(var m=0;m<=o.e.c-o.s.c;++m)t.push(null)}),(f||p)&&(f=f||1,p=p||1,e.push({s:{r,c:t.length},e:{r:r+f-1,c:t.length+p-1}})),t.push(h!==""?h:null),p)for(var u=0;u<p-1;++u)t.push(null)}i.push(t)}return[i,e]}function T(a,i){var s=Date.parse(a);return(s-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3)}function _(a,i){for(var s={},e={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=a.length;++r)for(var t=0;t!=a[r].length;++t){e.s.r>r&&(e.s.r=r),e.s.c>t&&(e.s.c=t),e.e.r<r&&(e.e.r=r),e.e.c<t&&(e.e.c=t);var n={v:a[r][t]};if(n.v!=null){var v=b.encode_cell({c:t,r});typeof n.v=="number"?n.t="n":typeof n.v=="boolean"?n.t="b":n.v instanceof Date?(n.t="n",n.z=l._table[14],n.v=T(n.v)):n.t="s",s[v]=n}}return e.s.c<1e7&&(s["!ref"]=b.encode_range(e)),s}function S(){if(!(this instanceof S))return new S;this.SheetNames=[],this.Sheets={}}function x(a){for(var i=new ArrayBuffer(a.length),s=new Uint8Array(i),e=0;e!=a.length;++e)s[e]=a.charCodeAt(e)&255;return i}function B(a){var i=document.getElementById(a),s=A(i),e=s[1],r=s[0],t="SheetJS",n=new S,v=_(r);v["!merges"]=e,n.SheetNames.push(t),n.Sheets[t]=v;var c=y(n,{bookType:"xlsx",bookSST:!1,type:"binary"});w.saveAs(new Blob([x(c)],{type:"application/octet-stream"}),"test.xlsx")}function D({multiHeader:a=[],header:i,data:s,filename:e,merges:r=[],autoWidth:t=!0,bookType:n="xlsx"}={}){e=e||"excel-list",s=[...s],s.unshift(i);for(let f=a.length-1;f>-1;f--)s.unshift(a[f]);var v="SheetJS",c=new S,g=_(s);if(r.length>0&&(g["!merges"]||(g["!merges"]=[]),r.forEach(f=>{g["!merges"].push(b.decode_range(f))})),t){const f=s.map(u=>u.map(o=>o==null?{wch:10}:o.toString().charCodeAt(0)>255?{wch:o.toString().length*2}:{wch:o.toString().length}));let h=f[0];for(let u=1;u<f.length;u++)for(let o=0;o<f[u].length;o++)h[o].wch<f[u][o].wch&&(h[o].wch=f[u][o].wch);g["!cols"]=h}c.SheetNames.push(v),c.Sheets[v]=g;var p=y(c,{bookType:n,bookSST:!1,type:"binary"});w.saveAs(new Blob([x(p)],{type:"application/octet-stream"}),`${e}.${n}`)}export{D as export_json_to_excel,B as export_table_to_excel};
