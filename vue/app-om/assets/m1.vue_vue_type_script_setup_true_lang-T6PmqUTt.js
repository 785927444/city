import{_ as R}from"./Add-BFaa3Kc7.js";import{_ as S}from"./AaFoot-CD1CMZWQ.js";import{_ as T}from"./ListTree.vue_vue_type_script_setup_true_lang-gmpjaLIo.js";import{_ as V}from"./AbTitle.vue_vue_type_script_setup_true_lang-BE9n7PCf.js";import{d as q,g as $,r as j,b as B,j as b,n as f,o as h,c as k,a as u,w as A,u as d,e as D,_ as E,f as w,t as H,h as M,i as m}from"./index-CymMRwSV.js";const F={class:"layout-col"},L={class:"f14 ml2"},O={class:"layout-col bg-white"},U=q({__name:"m1",setup(P){const{proxy:s}=$(),o=s.publicStore(),n=s.configStore();s.dictStore();let p=m(),g=m(),y=m();const e=j({...o.$state,listRow:!0,listExpand:!0,content:[{width:"flex1",show:!0,align:"left",key:"station_name",name:"名称",type:"icon1"}],editFrom:[{required:!0,editshow:"none",name:"上级",key:"parent_id",type:"input"},{required:!0,editshow:!0,name:"名称",key:"station_name",type:"input"},{required:!1,editshow:!0,name:"排序",key:"order",type:"input"}],addItem:{parent_id:"0"}});B(async()=>{o.init({path:"/station"},e),n.distributId||(n.distributId="0"),_()}),b(()=>o.isTrue,async i=>{await f(),_(o.active.id)},{immediate:!1,deep:!0}),b(()=>n.distributId,async(i,t)=>{await f(),!s.isNull(i)&&_()},{immediate:!1,deep:!0});const _=async i=>{let t=[];if(!s.isNull(n.stations))!n.distributId||n.distributId=="0"?t=[...n.stations]:t=n.stations.filter(a=>a.id==n.distributId);else{e.query=!n.distributId||n.distributId=="0"?{model:e.model}:{model:e.model,args:`id='${n.distributId}'`},e.params={Api:e.query};let a=await o.http(e.params);t=s.isNull(a)?[]:a.sort((l,r)=>l.order-r.order)}e.empty=!!s.isNull(t),e.list=t,o._public.list=e.list,o._public.stations=e.list,I(i)},I=async i=>{e.tree=s.treeData(e.list,e.key,e.parent,"children");let t=s.findNode(e.tree,r=>!r.children),a=s.findNode(e.tree,r=>r[e.key]==i),l=s.isNull(a)?t:a;l&&(await f(),y.value.handleNodeClick(l))},N=i=>{o.active={...i}},v=async(i,t)=>{(i=="add"||i=="upd")&&p.value.onVisable(t),i=="del"&&p.value.del(t),i=="detail"&&g.value.onVisable(t),i=="active"&&(o.active=t)};return(i,t)=>{const a=E,l=V,r=T,C=S,x=R;return h(),k("div",F,[u(l,{title:"区域"},{"right-content":A(()=>[d(e).content.find(c=>typeof c.key=="object")&&d(e).content.find(c=>typeof c.key=="object").key.hasOwnProperty("add")?(h(),k("div",{key:0,class:"rad4 ptb5 plr8 flex-cc cursor bgi1 white ml10",onClick:t[0]||(t[0]=D(c=>d(p).onVisable(d(e).addItem),["stop"]))},[u(a,{class:"f12 fw"}),w("span",L,H(d(e).content.find(c=>typeof c.key=="object").key.add),1)])):M("",!0)]),_:1}),w("div",O,[u(r,{onHandleNodeClick:N,onHandleClick:v,state:d(e),ref_key:"listTreeRef",ref:y},null,8,["state"])]),u(C),u(x,{onInit:_,state:d(e),ref_key:"addRef",ref:p},null,8,["state"])])}}});export{U as _};
