import{d as q,g as w,r as J,ce as O,b as B,o as E,c as I,f as d,t as T,u as i,e as M,a as m,k as f,v as y,a6 as C,a9 as D,aa as F}from"./index-C0LFq0t5.js";import{_ as L}from"./stepTitle.vue_vue_type_script_setup_true_lang-Dbt8kiKZ.js";import P from"./step1-DOrhDy6J.js";import V from"./step2-C-qYAko6.js";import j from"./step3-dzc_ho_4.js";import"./FileList.vue_vue_type_script_setup_true_lang-DtMaAncq.js";import"./ViewFiles-DAOzOFJI.js";import"./UploadText-D6BCvpgB.js";/* empty css                    *//* empty css                   */import"./index-C9K-_7OE.js";import"./index-DCe-bV3q.js";/* empty css                                                                   *//* empty css                    */import"./areaData-CfkeTXdx.js";import"./projects.vue_vue_type_script_setup_true_lang-r5WgPrdK.js";import"./el-loading-D7qlqRqj.js";import"./Pagination.vue_vue_type_style_index_0_lang-BA7bW-pp.js";import"./el-pagination-BB8JCOIr.js";/* empty css                        */import"./AaTitle.vue_vue_type_script_setup_true_lang-BnIAtUUF.js";import"./index-DJZt49th.js";import"./index-DefrYvvh.js";import"./v6-B4YtUg27.js";const R={class:"layout-col plr15"},z={class:"layout-col white-rgba50 rad8"},G={class:"ww100 flex-bc f20 p15 mb20 bob-cd-1"},H={class:"fw"},K={class:"flex1 flex-ec"},Q={class:"layout-col"},bt=q({__name:"index",setup(U){const _=C(),{proxy:c}=w(),a=c.publicStore();c.configStore();const s=J({...a.$state});O(async()=>{a.actIndex=1,a.form={}}),B(async()=>{h()});const h=async l=>{let t={};if(_.query&&_.query.id){let e={model:"t_project_report",args:`id='${_.query.id}'`},p=await a.http({Api:e});t=c.isNull(p)?{}:{...p[0]},t.apply_status=="0"&&(a.title="apply"),t.apply_status=="1"&&t.reserve_status=="0"&&(a.title="reserve")}if(t.area)try{t.area=JSON.parse(t.area)}catch(e){console.error("解析失败:",e.message)}else t.area=[];if(t.fund_source)try{t.fund_source=JSON.parse(t.fund_source)}catch(e){console.error("解析失败:",e.message)}else t.fund_source={value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",value7:"",value8:"",value9:"",value10:""};if(t.orther_text)try{t.orther_text=JSON.parse(t.orther_text)}catch(e){console.error("解析失败:",e.message)}else t.orther_text={value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",value7:"",value8:"",value9:"",value10:"",value11:"",value12:"",value13:"",value14:"",value15:""};if(t.attr)try{t.attr=JSON.parse(t.attr)}catch(e){console.error("解析失败:",e.message)}else t.attr={};if(t.plan_attr)try{t.plan_attr=JSON.parse(t.plan_attr)}catch(e){console.error("解析失败:",e.message)}else t.plan_attr={};a.form={...t},a._public.form=JSON.parse(JSON.stringify(t)),v(),g(),b(),N(),A()},v=async()=>{let l={model:"t_scheme_plan",args:"release_status='1'",field:"id, name"};a.http({Api:l}).then(t=>{a._public.schemePlans=c.isNull(t)?[]:t})},g=async()=>{a._public.schemeAreas=[{id:"1",name:"龙城片区"}]},b=async()=>{let l={model:"t_task_type"},t={model:"t_task_content"};a.http({Api1:l,Api2:t}).then(e=>{c.isNull(e.Api1)||e.Api1;let p=c.isNull(e.Api2)?[]:e.Api2;const n=e.Api1.filter(o=>o.parent_id==="0").map(o=>o.id),r=e.Api1.filter(o=>n.includes(o.parent_id)),u=e.Api1.filter(o=>r.map($=>$.id).includes(o.parent_id));a._public.task_types=r,a._public.task_classs=u,a._public.construct_contents=p})},N=async()=>{let l={model:"t_scheme_task",args:`scheme_id='${a.form.scheme_id}'`};a.http({Api:l}).then(t=>{let e=c.isNull(t)?[]:t;a.form.tasks=[...t],a._public.tasks=JSON.parse(JSON.stringify(e))})},A=async()=>{let l={model:"t_file_type"},t={model:"t_file_content"},e=await a.http({Api1:l,Api2:t}),p=c.isNull(e.Api1)?[]:e.Api1.sort((r,u)=>r.orderd-u.orderd),n=c.isNull(e.Api2)?[]:e.Api2.sort((r,u)=>r.orderd-u.orderd);x(p,n,"019c2c63-cf59-719f-b942-7c7bb535413d"),k(p,n,"019c2cc4-d276-7805-9685-7a5dde449721")},x=(l,t,e)=>{let p=l.find(n=>n.id==e);if(p){let n=[];s.plans=l.filter(r=>r.parent_id==e),s.plans.forEach(r=>{r.parent_type=`${p.type}/${r.type}`;let u=t.filter(o=>o.parent_id==r.id);c.isNull(u)||u.forEach(o=>{o.parent_type=`${r.parent_type}/${o.type}`,n.push(o)})}),s.contents1=n,a._public.contents1=n,s.active1=c.isNull(s.plans)?{}:{...s.plans[0]}}},k=(l,t,e)=>{let p=l.find(n=>n.id==e);if(p){let n=[];s.plans=l.filter(r=>r.parent_id==e),s.plans.forEach(r=>{r.parent_type=`${p.type}/${r.type}`;let u=t.filter(o=>o.parent_id==r.id);c.isNull(u)||u.forEach(o=>{o.parent_type=`${r.parent_type}/${o.type}`,n.push(o)})}),s.contents2=n,a._public.contents2=n,s.active2=c.isNull(s.plans)?{}:{...s.plans[0]}}},S=()=>{let l=a.form.id?"正在编辑中,是否确定退出?":"正在编辑中,信息未保存是否确定退出?";D.confirm(l,"温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{F.back()})};return(l,t)=>(E(),I("div",R,[d("div",z,[d("div",G,[d("div",H,T(i(_).query&&i(_).query.id?"创建项目":"信息补充"),1),d("div",K,[d("div",{class:"plr14 ptb5 rad4 mr15 cursor c9 bg-white bo-c9-1",onClick:t[0]||(t[0]=M(e=>S(),["stop"]))},"返 回")])]),d("div",Q,[m(i(L)),f(m(i(P),{state:i(s),contents:i(s).contents1,active:i(s).active1},null,8,["state","contents","active"]),[[y,i(a).actIndex==1]]),f(m(i(V),{state:i(s),contents:i(s).contents2,active:i(s).active2},null,8,["state","contents","active"]),[[y,i(a).actIndex==2]]),f(m(i(j),{state:i(s),contents:i(s).contents2,active:i(s).active2},null,8,["state","contents","active"]),[[y,i(a).actIndex==3]])])])]))}});export{bt as default};
