import{d as J,g as Q,b as W,o as u,c as v,a as t,w as o,df as X,r as ee,i as p,dg as ae,f as a,a1 as d,Z as te,$ as le,a8 as se,m as oe,q as ne,F as x,p as E,z as N,E as ie,a0 as de,e as C,t as r,cx as re,dh as ce,x as $,l as ue}from"./index-C0LFq0t5.js";import{E as pe}from"./el-pagination-BB8JCOIr.js";/* empty css               *//* empty css                    */import{E as _e}from"./el-card-M-h8gQ7j.js";import{E as me,a as ve}from"./index-DGWVBOJ9.js";import{E as fe}from"./index-DefrYvvh.js";const ge={class:"annual-plan-container"},be={class:"list-section"},ye={class:"list-header"},he={class:"list-actions"},ke={class:"card-header"},we={class:"city-name"},Ve={class:"header-right"},xe={class:"card-content"},Ee={class:"info-row"},Ce={class:"value"},De={class:"info-row"},Ae={class:"value"},Ne={class:"info-row"},$e={class:"value"},Ue={class:"info-row"},Se={class:"value"},Ye={class:"info-row"},Me={class:"value"},Pe={class:"pagination-container"},ze={class:"sidebar-actions"},Ie={class:"bar-chart-placeholder"},Be={class:"bar-label"},Fe={class:"bar-container"},Le={class:"bar-group"},Te={class:"bar-value pink-text"},je={class:"bar-group"},Oe={class:"bar-value cyan-text"},Re=J({__name:"index",setup(Ke){const{proxy:f}=Q(),U=f.publicStore(),s=ee({period:"",city:"",district:"",stage:"",investment:"",type:"",keyword:""}),g=p([]),h=p([]),D=p(0),A=p(9),k=p(1),S=p([{name:"太原六城区",count:13,amount:203},{name:"古交市",count:10,amount:219},{name:"娄烦县",count:23,amount:225},{name:"阳曲县",count:14,amount:167},{name:"清徐县",count:15,amount:143}]),Y=n=>{n==="太原市"?g.value=["小店区","迎泽区","杏花岭区","尖草坪区","万柏林区","晋源区","古交市","清徐县","阳曲县","娄烦县"]:n==="大同市"?g.value=["平城区","云冈区","新荣区","云州区","阳高县","天镇县"]:g.value=[],s.district=""},M=n=>({passed:"success",special_audit:"warning",failed:"danger",wait_report:"info",in_progress:""})[n]||"",P=n=>({passed:"已通过",special_audit:"特审候",failed:"不通过",wait_report:"待上报",in_progress:"进行中"})[n]||n,w=async()=>{let n="1=1";s.period&&(n+=` AND report_time = '${s.period}'`),s.city&&(n+=` AND city_name = '${s.city}'`),s.district&&(n+=` AND district_name = '${s.district}'`),s.stage&&(n+=` AND project_stage = '${s.stage}'`),s.type&&(n+=` AND project_type = '${s.type}'`),s.keyword&&(n+=` AND (city_name LIKE '%${s.keyword}%' OR report_unit LIKE '%${s.keyword}%')`),s.investment==="gt5000"&&(n+=" AND investment_amount >= 5000"),s.investment==="lt5000"&&(n+=" AND investment_amount < 5000");try{const e=await U.http({Api:{model:"t_annual_plan_report",args:n,order:"report_time desc",page:k.value,limit:A.value}});e&&e.list?(h.value=e.list.map(V=>({...V,checked:!1})),D.value=e.total||50):h.value=Array.isArray(e)?e:[]}catch(e){console.error("Failed to fetch data:",e)}},z=n=>{!n||!n.id||f.toPath(`/annual-plan/${n.id}`)},I=()=>{f.toPath("/annual-plan/track")},B=()=>{f.toPath("/annual-plan/report")},F=n=>{k.value=n,w()};return W(()=>{w()}),(n,e)=>{const V=se,c=le,i=ne,_=oe,L=ie,m=de,T=te,b=_e,j=re,O=fe,R=ve,K=me,q=pe,Z=ae,G=ce,H=X;return u(),v("div",ge,[t(H,null,{default:o(()=>[t(Z,{class:"main-content"},{default:o(()=>[e[16]||(e[16]=a("div",{class:"breadcrumb"},[a("span",{class:"home-icon"},[a("i",{class:"el-icon-s-home"}),d(" 城市更新")]),a("span",{class:"separator"},"/"),a("span",{class:"current"},"实施与调度管理")],-1)),t(b,{class:"filter-card"},{default:o(()=>[t(T,{inline:!0,model:s,class:"filter-form"},{default:o(()=>[t(c,{label:"项目周期"},{default:o(()=>[t(V,{modelValue:s.period,"onUpdate:modelValue":e[0]||(e[0]=l=>s.period=l),type:"date",placeholder:"请选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(c,{label:"所属地区"},{default:o(()=>[t(_,{modelValue:s.city,"onUpdate:modelValue":e[1]||(e[1]=l=>s.city=l),placeholder:"请选择市",style:{width:"120px","margin-right":"10px"},onChange:Y},{default:o(()=>[t(i,{label:"太原市",value:"太原市"}),t(i,{label:"大同市",value:"大同市"}),t(i,{label:"阳泉市",value:"阳泉市"}),t(i,{label:"长治市",value:"长治市"}),t(i,{label:"晋城市",value:"晋城市"}),t(i,{label:"朔州市",value:"朔州市"}),t(i,{label:"晋中市",value:"晋中市"}),t(i,{label:"运城市",value:"运城市"}),t(i,{label:"忻州市",value:"忻州市"}),t(i,{label:"临汾市",value:"临汾市"}),t(i,{label:"吕梁市",value:"吕梁市"})]),_:1},8,["modelValue"]),t(_,{modelValue:s.district,"onUpdate:modelValue":e[2]||(e[2]=l=>s.district=l),placeholder:"请选择区/县",style:{width:"120px"}},{default:o(()=>[(u(!0),v(x,null,E(g.value,l=>(u(),N(i,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"项目阶段"},{default:o(()=>[t(_,{modelValue:s.stage,"onUpdate:modelValue":e[3]||(e[3]=l=>s.stage=l),placeholder:"请选择"},{default:o(()=>[t(i,{label:"储备阶段",value:"储备阶段"}),t(i,{label:"实施阶段",value:"实施阶段"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"总投资金额"},{default:o(()=>[t(_,{modelValue:s.investment,"onUpdate:modelValue":e[4]||(e[4]=l=>s.investment=l),placeholder:"请选择"},{default:o(()=>[t(i,{label:"5千万以上",value:"gt5000"}),t(i,{label:"5千万以下",value:"lt5000"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"项目类型"},{default:o(()=>[t(_,{modelValue:s.type,"onUpdate:modelValue":e[5]||(e[5]=l=>s.type=l),placeholder:"请选择",style:{width:"180px"}},{default:o(()=>[t(i,{label:"加强既有建筑改造利用",value:"加强既有建筑改造利用"}),t(i,{label:"完善社区服务设施",value:"完善社区服务设施"})]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:o(()=>[t(L,{modelValue:s.keyword,"onUpdate:modelValue":e[6]||(e[6]=l=>s.keyword=l),placeholder:"请输入",style:{width:"150px"}},null,8,["modelValue"])]),_:1}),t(c,null,{default:o(()=>[t(m,{type:"primary",onClick:w},{default:o(()=>[...e[7]||(e[7]=[d("搜索",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a("div",be,[a("div",ye,[e[10]||(e[10]=a("h3",{class:"section-title"},"年度计划",-1)),a("div",he,[t(m,null,{default:o(()=>[...e[8]||(e[8]=[d("全选",-1)])]),_:1}),t(m,{type:"primary"},{default:o(()=>[...e[9]||(e[9]=[d("提醒",-1)])]),_:1})])]),t(K,{gutter:20},{default:o(()=>[(u(!0),v(x,null,E(h.value,l=>(u(),N(R,{span:8,key:l.id,style:{"margin-bottom":"20px"}},{default:o(()=>[t(b,{class:"data-card",onClick:C(y=>z(l),["stop"])},{header:o(()=>[a("div",ke,[a("span",we,r(l.city_name),1),a("div",Ve,[t(j,{type:M(l.status),effect:"dark",size:"small",class:"status-tag"},{default:o(()=>[d(r(P(l.status)),1)]),_:2},1032,["type"]),t(O,{modelValue:l.checked,"onUpdate:modelValue":y=>l.checked=y},null,8,["modelValue","onUpdate:modelValue"])])])]),default:o(()=>[a("div",xe,[a("div",Ee,[e[11]||(e[11]=a("span",{class:"label"},"上报时间：",-1)),a("span",Ce,r(l.report_time||"-"),1)]),a("div",De,[e[12]||(e[12]=a("span",{class:"label"},"计划年度：",-1)),a("span",Ae,r(l.plan_year),1)]),a("div",Ne,[e[13]||(e[13]=a("span",{class:"label"},"年度投资估算：",-1)),a("span",$e,r(l.investment_amount)+"万元",1)]),a("div",Ue,[e[14]||(e[14]=a("span",{class:"label"},"包含项目数：",-1)),a("span",Se,r(l.project_count)+"个",1)]),a("div",Ye,[e[15]||(e[15]=a("span",{class:"label"},"上报单位：",-1)),a("span",Me,r(l.report_unit||"-"),1)])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),a("div",Pe,[t(q,{background:"",layout:"prev, pager, next",total:D.value,"page-size":A.value,"current-page":k.value,onCurrentChange:F},null,8,["total","page-size","current-page"])])])]),_:1}),t(G,{width:"400px",class:"right-sidebar"},{default:o(()=>[a("div",ze,[t(m,{type:"primary",class:"action-btn",onClick:C(B,["stop"])},{default:o(()=>[...e[17]||(e[17]=[d("年度计划上报",-1)])]),_:1}),t(m,{class:"action-btn",onClick:C(I,["stop"])},{default:o(()=>[...e[18]||(e[18]=[d("年度计划跟踪",-1)])]),_:1})]),t(b,{class:"chart-card"},{header:o(()=>[...e[19]||(e[19]=[a("div",{class:"chart-header"},"年度计划上报情况",-1)])]),default:o(()=>[e[20]||(e[20]=a("div",{class:"stats-summary"},[a("div",null,[d("共"),a("span",{class:"highlight"},"11"),d("个地市")]),a("div",{class:"pie-chart-placeholder"},[a("div",{class:"pie-circle"},[a("span",{class:"percentage"},"60%")])]),a("div",null,[a("div",null,[d("共"),a("span",{class:"highlight blue"},"160"),d("个县")]),a("div",null,[a("span",{class:"highlight blue"},"55"),d("个县完成上报")])])],-1))]),_:1}),t(b,{class:"chart-card chart-card-tall"},{header:o(()=>[...e[21]||(e[21]=[a("div",{class:"chart-header"},"片区策划内容",-1)])]),default:o(()=>[e[22]||(e[22]=a("div",{class:"chart-legend"},[a("span",{class:"legend-item"},[a("span",{class:"dot pink"}),d("项目数量")]),a("span",{class:"legend-item"},[a("span",{class:"dot cyan"}),d("年度投资金额(万元)")])],-1)),a("div",Ie,[(u(!0),v(x,null,E(S.value,(l,y)=>(u(),v("div",{class:"bar-row",key:y},[a("span",Be,r(l.name),1),a("div",Fe,[a("div",Le,[a("div",{class:"bar pink",style:$({width:l.count*2+"px"})},null,4),a("span",Te,r(l.count),1)]),a("div",je,[a("div",{class:"bar cyan",style:$({width:l.amount/2+"px"})},null,4),a("span",Oe,r(l.amount),1)])])]))),128))])]),_:1})]),_:1})]),_:1})])}}}),Xe=ue(Re,[["__scopeId","data-v-7e456eea"]]);export{Xe as default};
