import{d as E,g as T,r as $,b as z,n as M,o as i,c as a,f as l,u as n,e as j,a as k,_ as O,t as h,h as P,F as w,p as x,k as q,v as R,y as g,x as V,w as K,i as b}from"./index-C0LFq0t5.js";import{E as L}from"./el-text-CzfEDlFN.js";/* empty css                    */import{_ as G}from"./Add-Dm5MhgCZ.js";import"./index-DefrYvvh.js";/* empty css                    */import"./index-C9K-_7OE.js";import"./Upload-D980yyfb.js";/* empty css                   */import"./index-DCe-bV3q.js";const H={class:"layout-col"},J={class:"layout-col bss"},Q={class:"ww100 flex-bc plr12 ptb8 bs4"},U={class:"flex-ec flex1 h30"},W={class:"f14 ml5"},X={class:"row bgi22"},Y={class:"flex1 overlay ww100 flex-col-ss"},Z={class:"row"},ee=["onClick"],te={key:1},fe=E({__name:"index",setup(se){const{proxy:r}=T(),y=r.publicStore();r.configStore(),r.dictStore();const e=$({...y.$state,content:[{width:"flex1",show:!0,align:"left",key:"name",name:"名称"},{width:"w50x8",show:!0,align:"left",key:"path",name:"api接口"},{width:"w50x8",show:!0,align:"left",key:"order",name:"排序"},{width:"w50x10",show:!0,align:"right",key:{add:"创建",child:"添加",upd:"编辑",del:"删除"},name:"操作"}],editFrom:[{required:!0,editshow:!0,key:"parent_id",name:"上级",type:"tree",list:[],node_key:"id",parent_key:"parent_id",top_name:"顶级"},{required:!1,editshow:!0,key:"name",name:"名称",type:"input"},{required:!1,editshow:!0,key:"path",name:"api接口",type:"input"},{required:!1,editshow:!0,key:"order",name:"排序",type:"input"}]});let f=b(),v=b(),_=b(),F={children:"children",label:"name"};z(async()=>{C()});const C=async o=>{e.params={Api:e.query};let s=await y.post(e.params,e.url.list);e.empty=!!r.isNull(s),e.list=r.isNull(s)?[]:s.sort((d,p)=>d.order-p.order),y._public.list=e.list,e.editFrom[0].list=e.list,I(o)},I=async o=>{e.tree=r.treeData(e.list,e.key,e.parent,"children");let s=r.findNode(e.tree,t=>!t.children),d=r.findNode(e.tree,t=>t[e.key]==o),p=r.isNull(d)?s:d;await M(),N(p)},N=async o=>{_.value=o[e.key],v.value.setCurrentKey(_.value,!0),y.active=o},S=(o,s)=>{if((o=="add"||o=="upd")&&f.value.onVisable(s),o=="child"){let d=r.varObj(e.parent,s[e.key]);f.value.onVisable(d)}o=="del"&&f.value.del(s,e.key,e.url.del)};return(o,s)=>{const d=O,p=L;return i(),a("div",H,[l("div",J,[l("div",Q,[s[1]||(s[1]=l("div",{class:"flex-sc"},[l("span",{class:"f15 fw"},"权限列表")],-1)),l("div",U,[n(e).auth.add&&n(e).content.find(t=>typeof t.key=="object")&&n(e).content.find(t=>typeof t.key=="object").key.hasOwnProperty("add")?(i(),a("div",{key:0,class:"rad4 ptb6 plr10 flex-cc cursor bgi3 white ml10",onClick:s[0]||(s[0]=j(t=>S("add",n(e).addItem),["stop"]))},[k(d,{class:"f12 fw"}),l("span",W,h(n(e).content.find(t=>typeof t.key=="object").key.add),1)])):P("",!0)])]),l("div",X,[(i(!0),a(w,null,x(n(e).content,(t,u)=>q((i(),a("div",{style:V({textAlign:t.align,paddingRight:t.name=="操作"?"10px":"inherit"}),key:u,class:g(t.width)},h(t.name),7)),[[R,t.show]])),128))]),l("div",Y,[k(p,{class:"ww100",ref_key:"treeRef",ref:v,data:n(e).tree,"node-key":n(e).key,"current-node-key":n(_),props:n(F),"highlight-current":"",accordion:"",onNodeClick:N,"empty-text":"暂无数据"},{default:K(({node:t,data:u})=>[l("span",Z,[(i(!0),a(w,null,x(n(e).content,(c,A)=>q((i(),a("div",{class:g(c.width),style:V({textAlign:c.align}),key:A},[typeof c.key=="object"?(i(!0),a(w,{key:0},x(c.key,(B,m,D)=>(i(),a("span",{class:g(["i21 cursor mlr5",m=="add"||n(e).auth[m]==!1?"none":""]),key:D,onClick:j(ne=>S(m,u),["stop"])},h(B),11,ee))),128)):(i(),a("span",te,h(o.isNull(u[c.key])&&c.key!=""?"/":u[c.key]),1))],6)),[[R,c.show]])),128))])]),_:1},8,["data","node-key","current-node-key","props"])]),k(n(G),{onInit:C,state:n(e),ref_key:"exposeRef",ref:f},null,8,["state"])])])}}});export{fe as default};
