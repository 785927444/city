import{d as R,g as M,a6 as j,r as z,b as D,o as c,c as m,a as p,w as _,f as l,e as f,a8 as L,u as a,m as K,F as k,p as x,z as C,q as G,E as H,t as d,h as I,y as T,k as J,v as Q,a0 as W,a1 as q,a2 as X,a9 as Z,a4 as O,l as tt}from"./index-ClTGGYJq.js";import{_ as et}from"./Pagination.vue_vue_type_style_index_0_lang-u8YgO5nZ.js";import{_ as st}from"./check-ETYKhhpS.js";import{_ as lt}from"./AaTitle.vue_vue_type_script_setup_true_lang-DQZ6AruM.js";import{_ as at}from"./filter-CPm302q-.js";import"./el-pagination-B7EgBbn6.js";const it={class:"layout-col"},ot={class:"flex-sc mr30"},nt={class:"w50x4"},ct={class:"flex-sc mr30"},rt={class:"w50x3"},pt={class:"flex-sc mr30"},dt={class:"w50x3"},ut={class:"flex-sc mr15"},mt={class:"w50x3"},_t={class:"flex-sc mr15"},ft={class:"w50x3"},yt={class:"layout-col bg-white rad8 p8"},wt={class:"ww100 flex-sc p8"},gt={class:"flex-sc fw f16 tc"},bt=["onClick"],vt={key:0,class:"w20 h20 rad2 lh20 tc bgi13 i15 b20 l50 absolute"},kt={class:"mb5"},xt={class:"flex-ec flex1"},ht={class:"table flex-sc warp"},$t={class:"ww100 bs bo-i16-1 relative rad8"},Ct={class:"ww100 flex-sc p12 bob-ce-1"},At={class:"f15"},Vt={class:"flex1 flex-ec"},Nt=["onClick"],Et={class:"ww100 flex-col p12 c6"},Ut={class:"ww100 flex-sc"},St={class:"ww100 flex-sc mt10"},It={class:"ww100 flex-sc mt10"},Tt={class:"ww100 flex-sc mt10"},qt={class:"ww100 flex-sc mt10"},Ot={class:"ww100 flex-sc mt10"},Bt={class:"ww100 flex-sc mt10"},Ft={class:"flex-sc flex1"},Yt=["onClick"],Pt={class:"dialog-footer"},Rt=R({__name:"index",setup(Mt){const{proxy:r}=M(),b=r.publicStore(),y=r.configStore(),B=r.dictStore();j();const s=z({...b.$state,click:!1,clickArr:[],provinces:[],province:"",citys:[],city:"",types:[{type:"actionRelease",name:"已上报",path:"/actionRelease"},{type:"actionApply",name:"已申请",path:"/actionApply"},{type:"actionReturn",name:"已退回",path:"/actionReturn"}],type:"actionRelease",completion_status:"1",search:"",schemeAreas:[{value:"1",name:"龙城片区"}]});D(async()=>{await F(),A()});const F=async()=>{s.provinces=[{name:y.user.province_name,value:y.user.province}],s.province=s.provinces[0].value;let o=y.user.parent_id=="0"?{model:"t_station",args:`parent_id='${y.user.station_num}'`}:{model:"t_station",args:`id='${y.user.station_num}'`},t=await b.http({Api:o}),w=r.isNull(t)?[]:t.sort((i,g)=>i.order-g.order);s.citys=w.map(i=>({name:i.station_name,value:i.city})),!r.isNull(s.citys)&&y.user.parent_id!="0"&&(s.city=s.citys[0].value)},A=async o=>{let t="t_project_report",w="apply_status = '0'",i="apply_status = '1'",g="apply_status = '3'",u={model:t,args:w},V={model:t,field:"COUNT(*)",args:i},N={model:t,field:"COUNT(*)",args:g};if(Y(V),P(N),s.province){if(u.args+=` and province='${s.province}'`,s.city&&(u.args+=` and city='${s.city}'`),!r.isNull(s.construct_datetime)){const[n,$]=s.construct_datetime;u.args+=` and construct_datetime_start>='${n}' and construct_datetime_end<='${$}'`}s.completion_status&&(u.args+=` and completion_status='${s.completion_status}'`),s.search&&(u.args+=` and name LIKE '%${s.search}%'`)}let E={limit:s.limit,page:s.page},U={field:"COUNT(*)"},v={},h={};Object.assign(v,u,E),Object.assign(h,u,U);let e=await b.http({Api1:v,Api2:h});s.total=r.isNull(e.Api2)?0:e.Api2[0]["COUNT(*)"],s.empty=!!r.isNull(e.Api1),s.list=r.isNull(e.Api1)?[]:e.Api1,s.list.forEach(n=>{n.area=(n.province_name||"")+(n.city_name?`-${n.city_name}`:"")+(n.district_name?`-${n.district_name}`:"")})},Y=o=>{b.http({Api:o}).then(t=>{s.types[1].total=r.isNull(t)?0:t[0]["COUNT(*)"]})},P=o=>{b.http({Api:o}).then(t=>{s.types[2].total=r.isNull(t)?0:t[0]["COUNT(*)"]})},S=(o,t)=>{o=="remind"&&Z.confirm("是否确定提醒?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{if(s.list.findIndex(i=>i.click)==-1)return O({title:"提示",message:"请选择至少一个",type:"error"});O({title:"提示",message:"提醒成功",type:"success"})}),o=="selectAll"&&(s.list.findIndex(i=>i.click)==-1?(s.click=!0,s.list.forEach(i=>{i.click=!0,s.clickArr.push(i)})):(s.click=!1,s.clickArr=[],s.list.forEach(i=>{delete i.click})))};return(o,t)=>{const w=L,i=G,g=K,u=H,V=at,N=lt,E=st,U=et,v=W,h=X;return c(),m("div",it,[p(N,{title:""},{"left-content":_(()=>[l("div",ot,[t[14]||(t[14]=l("span",{class:"mr10"},"项目周期",-1)),l("span",nt,[p(w,{style:{width:"100%"},modelValue:a(s).construct_datetime,"onUpdate:modelValue":t[0]||(t[0]=e=>a(s).construct_datetime=e),"start-placeholder":"开始周期","end-placeholder":"结束周期",type:"yearrange","value-format":"YYYY",format:"YYYY"},null,8,["modelValue"])])]),l("div",ct,[t[15]||(t[15]=l("span",{class:"mr10"},"所属行政",-1)),l("span",rt,[p(g,{modelValue:a(s).province,"onUpdate:modelValue":t[1]||(t[1]=e=>a(s).province=e),placeholder:"请选择",style:{width:"100%"},filterable:""},{default:_(()=>[(c(!0),m(k,null,x(a(s).provinces,(e,n)=>(c(),C(i,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",pt,[t[16]||(t[16]=l("span",{class:"mr10"},"所属地市",-1)),l("span",dt,[p(g,{modelValue:a(s).city,"onUpdate:modelValue":t[2]||(t[2]=e=>a(s).city=e),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:a(y).user.parent_id=="0"},{default:_(()=>[(c(!0),m(k,null,x(a(s).citys,(e,n)=>(c(),C(i,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","clearable"])])]),l("div",ut,[t[17]||(t[17]=l("span",{class:"mr10"},"实施状态",-1)),l("span",mt,[p(g,{modelValue:a(s).completion_status,"onUpdate:modelValue":t[3]||(t[3]=e=>a(s).completion_status=e),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{default:_(()=>[(c(!0),m(k,null,x(a(B).project_completion_statuss,(e,n)=>(c(),C(i,{key:e.value,value:String(e.value),label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",_t,[t[18]||(t[18]=l("span",{class:"mr10"},"项目名称",-1)),l("span",ft,[p(u,{modelValue:a(s).search,"onUpdate:modelValue":t[4]||(t[4]=e=>a(s).search=e),style:{width:"100%"},placeholder:"请输入"},null,8,["modelValue"])])]),l("div",{class:"rad4 ptb6 plr12 flex-cc cursor bgi1 white",onClick:t[5]||(t[5]=f(e=>A(),["stop"]))},[p(V,{class:"f12 fw"}),t[19]||(t[19]=l("span",{class:"f14 ml5"},"搜索",-1))])]),"right-content":_(()=>[l("div",{class:"rad4 ptb6 plr12 flex-cc cursor bg-white c8 bo-cc-1",onClick:t[6]||(t[6]=f(e=>o.toPath("/actionApply"),["stop"]))},"新建项目")]),_:1}),l("div",yt,[l("div",wt,[l("div",gt,[(c(!0),m(k,null,x(a(s).types,(e,n)=>(c(),m("div",{class:"mr40 cursor flex-col-cc relative",key:n,onClick:f($=>o.toPath(e.path),["stop"])},[e.total?(c(),m("span",vt,d(e.total),1)):I("",!0),l("span",kt,d(e.name),1),l("span",{class:T(["ww100 h3 rad10",e.type==a(s).type?"bgi2":"black-rgba0"])},null,2)],8,bt))),128))]),l("div",xt,[l("div",{class:"rad4 ptb5 plr12 flex-cc cursor bg-white c8 bo-cc-1 ml15",onClick:t[7]||(t[7]=f(e=>S("selectAll"),["stop"]))},"全选"),l("div",{class:"rad4 ptb5 plr12 flex-cc cursor bgi1 white bo-i1-1 ml15",onClick:t[8]||(t[8]=f(e=>S("remind"),["stop"]))},"提醒")])]),l("div",ht,[(c(!0),m(k,null,x(a(s).list,(e,n)=>(c(),m("div",{class:"ww25 cursor p8",key:n},[l("div",$t,[l("div",Ct,[l("span",At,d(e.name),1),l("span",Vt,[l("span",{class:T(["w18 h18 tc lh18 rad3 ml10 white f12",e.click?"bgi1 bo-i1-1":"bo-cc-1"]),onClick:f($=>e.click=!e.click,["stop"])},[e.click?(c(),C(E,{key:0})):I("",!0)],10,Nt)])]),l("div",Et,[l("div",Ut,[t[20]||(t[20]=l("span",{class:"w110"},"所属地区",-1)),l("span",null,d(e.area?e.area:""),1)]),l("div",St,[t[21]||(t[21]=l("span",{class:"w110"},"所属片区",-1)),l("span",null,d(e.parent_area?o.find(a(s).schemeAreas,["value",e.parent_area],"name"):"-"),1)]),l("div",It,[t[22]||(t[22]=l("span",{class:"w110"},"项目周期",-1)),l("span",null,d(e.construct_datetime_start&&e.construct_datetime_end?`${e.construct_datetime_start}-${e.construct_datetime_end}`:"-"),1)]),l("div",Tt,[t[23]||(t[23]=l("span",{class:"w110"},"项目规模",-1)),l("span",null,d(e.construct_scale?`${e.construct_scale}`:"-"),1)]),l("div",qt,[t[24]||(t[24]=l("span",{class:"w110"},"预估投入",-1)),l("span",null,d(e.construct_price?`${e.construct_price} 万元`:"-"),1)]),l("div",Ot,[t[25]||(t[25]=l("span",{class:"w110"},"项目性质",-1)),l("span",null,d(e.construct_nature?o.decrypt(e.construct_nature):"-"),1)]),l("div",Bt,[l("div",Ft,[t[26]||(t[26]=l("span",{class:"w110"},"更新进度时间",-1)),l("span",null,d(e.rate_time?o.parseTime(e.rate_time):"-"),1)]),l("div",{class:"rad5 ptb5 plr12 cursor bgi1 white",onClick:f($=>{a(s).active={...e},a(s).isFalse=!a(s).isFalse},["stop"])},"申请储备",8,Yt)])])])]))),128))]),J(p(U,{class:"",style:{"padding-bottom":"0"},total:a(s).total,page:a(s).page,"onUpdate:page":t[9]||(t[9]=e=>a(s).page=e),pageModifiers:{sync:!0},limit:a(s).limit,"onUpdate:limit":t[10]||(t[10]=e=>a(s).limit=e),limitModifiers:{sync:!0},onPagination:A},null,8,["total","page","limit"]),[[Q,a(s).total>0]])]),p(h,{modelValue:a(s).isFalse,"onUpdate:modelValue":t[13]||(t[13]=e=>a(s).isFalse=e),title:"温馨提示",draggable:!0,width:"30%"},{footer:_(()=>[l("div",Pt,[p(v,{size:"large",class:"bgc white",onClick:t[11]||(t[11]=e=>a(s).isFalse=!a(s).isFalse)},{default:_(()=>[...t[27]||(t[27]=[q("取 消",-1)])]),_:1}),p(v,{size:"large",class:"bgi1 white",onClick:t[12]||(t[12]=f(e=>o.toPath("/actionApply",{id:a(s).active.id}),["stop"]))},{default:_(()=>[...t[28]||(t[28]=[q("确 定",-1)])]),_:1})])]),default:_(()=>[t[29]||(t[29]=l("div",{class:"ww100 flex-col-cc"},[l("div",{class:"f20 tc ptb30"},"是否将该项目申请纳入储备")],-1))]),_:1},8,["modelValue"])])}}}),Ht=tt(Rt,[["__scopeId","data-v-410220d1"]]);export{Ht as default};
