import{d as A,g as B,r as b,b as N,o as v,c as g,f as s,a as e,w as a,n as D,i as F,Z as I,$ as P,m as T,F as L,p as R,z as h,q as Y,a0 as $,a1 as M,t as p,l as U}from"./index-ClTGGYJq.js";/* empty css               */import{E as q}from"./el-card-C35fswv6.js";import{e as z}from"./chart-xbrPpaRn.js";import{E as O,a as Z}from"./index-QIhAl26f.js";import"./index-Da8m4HG1.js";import"./linesGL-hPiCY4Q-.js";const G={class:"plan-track-container"},H={class:"stat-value"},J={class:"stat-value"},K={class:"stat-value"},Q={class:"stat-value"},W=A({__name:"track",setup(X){const{drawChart:c}=z(),{proxy:x}=B(),C=x.publicStore(),o=b({year:new Date().getFullYear(),city:"山西省"}),y=F([]),r=b({projectCount:0,planScale:0,totalInvestment:0,completionRate:0}),E=()=>{const l=new Date().getFullYear();y.value=[l-9,l-8,l-7,l-6,l-5,l-4,l-3,l-2,l-1,l]},j=async()=>{const l=[];o.year&&l.push(`plan_year='${o.year}'`),o.city&&l.push(`city_name='${o.city}'`);const t=l.length?l.join(" AND "):"1=1",n=await C.http({Api:{model:"t_annual_plan_report",args:t,field:"count(1) as cnt, sum(project_count) as proj_cnt, sum(investment_amount) as invest_sum",page:1,limit:1}}),d=Array.isArray(n)?n[0]:n&&n.list&&n.list[0]||{};r.projectCount=Number(d?.proj_cnt||133),r.planScale=Number(r.projectCount)*.62,r.totalInvestment=Math.floor(Number(d?.invest_sum||24900)/100)/100,r.completionRate=87.2},k=async()=>{const l={x:["2016年","2017年","2018年","2019年","2020年","2021年","2022年","2023年","2024年","2025年"],y:[22,30,31.4,28,75,60,46,28,36,29]};c("Line","Line_investTrend",{legendArr:["投资金额"],y_name:"亿元",tool_name_x:"年份",tool_name_y:"投资金额",tool_dw:"亿元"},{series:[{data:l.x.map((n,d)=>[n,l.y[d]])}]},{}),c("Pie","Pie_projectType",null,[{name:"城市更新品质提升",value:40},{name:"老旧小区改造",value:20},{name:"完善社区服务设施",value:20},{name:"历史风貌保护",value:20}],{name:"项目类型"});const t=[{name:"晋城市",count:33,amount:45},{name:"临汾市",count:45,amount:60},{name:"太原市",count:60,amount:80},{name:"长治市",count:50,amount:70},{name:"大同市",count:40,amount:65},{name:"忻州市",count:28,amount:54},{name:"运城市",count:30,amount:56},{name:"朔州市",count:26,amount:52},{name:"吕梁市",count:22,amount:48}];c("Bar","Bar_cityAnalysis",{legendArr:["项目数量","计划投资金额"],tool_name_x:"城市",tool_name_y:"数量/金额",labelShow:!1},{series:[{data:t.map(n=>[n.name,n.count])},{data:t.map(n=>[n.name,n.amount])}]},{}),c("Pie","Pie_amount",null,[{name:"已完成投资金额",value:20},{name:"待投资金额",value:30}],{name:"项目金额"})},w=async()=>{await j(),await D(),await k()};return N(async()=>{E(),await w()}),(l,t)=>{const n=Y,d=T,_=P,S=$,V=I,u=q,i=Z,f=O;return v(),g("div",G,[t[15]||(t[15]=s("div",{class:"breadcrumb"},"首页 / 年度计划跟踪",-1)),e(u,{class:"filter-card"},{default:a(()=>[e(V,{inline:!0,model:o},{default:a(()=>[e(_,{label:"年度"},{default:a(()=>[e(d,{modelValue:o.year,"onUpdate:modelValue":t[0]||(t[0]=m=>o.year=m),placeholder:"请选择",style:{width:"120px"}},{default:a(()=>[(v(!0),g(L,null,R(y.value,m=>(v(),h(n,{key:m,label:m+"年",value:m},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"行政区"},{default:a(()=>[e(d,{modelValue:o.city,"onUpdate:modelValue":t[1]||(t[1]=m=>o.city=m),placeholder:"请选择",style:{width:"150px"}},{default:a(()=>[e(n,{label:"山西省",value:"山西省"}),e(n,{label:"太原市",value:"太原市"}),e(n,{label:"大同市",value:"大同市"})]),_:1},8,["modelValue"])]),_:1}),e(_,null,{default:a(()=>[e(S,{type:"primary",onClick:w},{default:a(()=>[...t[2]||(t[2]=[M("查询",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(f,{gutter:16,class:"stats-row"},{default:a(()=>[e(i,{span:6},{default:a(()=>[e(u,{class:"stat-card"},{default:a(()=>[t[3]||(t[3]=s("div",{class:"stat-title"},"计划项目个数",-1)),s("div",H,p(r.projectCount),1)]),_:1})]),_:1}),e(i,{span:6},{default:a(()=>[e(u,{class:"stat-card"},{default:a(()=>[t[4]||(t[4]=s("div",{class:"stat-title"},"计划建设规模",-1)),s("div",J,p(r.planScale)+"亩",1)]),_:1})]),_:1}),e(i,{span:6},{default:a(()=>[e(u,{class:"stat-card"},{default:a(()=>[t[5]||(t[5]=s("div",{class:"stat-title"},"计划投资总额",-1)),s("div",K,p(r.totalInvestment)+"亿元",1)]),_:1})]),_:1}),e(i,{span:6},{default:a(()=>[e(u,{class:"stat-card"},{default:a(()=>[t[6]||(t[6]=s("div",{class:"stat-title"},"投资完成率",-1)),s("div",Q,p(r.completionRate)+"%",1)]),_:1})]),_:1})]),_:1}),e(f,{gutter:16,class:"chart-row"},{default:a(()=>[e(i,{span:12},{default:a(()=>[e(u,null,{header:a(()=>[...t[7]||(t[7]=[s("div",{class:"chart-title"},"年度投资金额趋势",-1)])]),default:a(()=>[t[8]||(t[8]=s("div",{id:"Line_investTrend",class:"chart"},null,-1))]),_:1})]),_:1}),e(i,{span:12},{default:a(()=>[e(u,null,{header:a(()=>[...t[9]||(t[9]=[s("div",{class:"chart-title"},"项目类型饼图",-1)])]),default:a(()=>[t[10]||(t[10]=s("div",{id:"Pie_projectType",class:"chart"},null,-1))]),_:1})]),_:1})]),_:1}),e(f,{gutter:16,class:"chart-row"},{default:a(()=>[e(i,{span:12},{default:a(()=>[e(u,null,{header:a(()=>[...t[11]||(t[11]=[s("div",{class:"chart-title"},"年度计划拟交叉分析图",-1)])]),default:a(()=>[t[12]||(t[12]=s("div",{id:"Bar_cityAnalysis",class:"chart"},null,-1))]),_:1})]),_:1}),e(i,{span:12},{default:a(()=>[e(u,null,{header:a(()=>[...t[13]||(t[13]=[s("div",{class:"chart-title"},"项目金额饼图",-1)])]),default:a(()=>[t[14]||(t[14]=s("div",{id:"Pie_amount",class:"chart"},null,-1))]),_:1})]),_:1})]),_:1})])}}}),rt=U(W,[["__scopeId","data-v-8e4df788"]]);export{rt as default};
