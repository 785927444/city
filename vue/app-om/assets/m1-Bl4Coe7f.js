import{_ as P}from"./Pagination.vue_vue_type_style_index_0_lang-Bbrys9lg.js";import{_ as j}from"./check-DrP440r6.js";import{_ as z}from"./AaTitle.vue_vue_type_script_setup_true_lang-msvlqApB.js";import{_ as F}from"./filter-BWaskIWj.js";import{d as L,g as K,a6 as G,r as H,b as J,o as c,c as d,a as f,w,f as l,a8 as Q,u as a,m as W,F as v,p as h,z as b,q as X,E as Z,e as k,t as u,h as E,y as U,db as tt,k as et,v as st,a9 as lt,a4 as T,l as at}from"./index-BF5jje68.js";import"./el-pagination-CLehCad4.js";const it={class:"layout-col"},nt={class:"flex-sc flex4 hidden warp"},ot={class:"flex-sc ww25 pr30"},ct={class:"flex1 flex-sc hidden"},rt={class:"flex-sc ww25 pr30"},pt={class:"flex1 flex-sc hidden"},dt={class:"flex-sc ww25 pr30"},ut={class:"flex1 flex-sc hidden"},mt={class:"flex-sc ww25 pr30"},_t={class:"flex1 flex-sc hidden"},ft={class:"flex-sc ww25 pr30 mt10"},yt={class:"flex1 flex-sc hidden"},gt={class:"flex-sc ww25 pr30 mt10"},wt={class:"flex1 flex-sc hidden"},vt={class:"flex-sc ww25 pr30 mt10"},ht={class:"flex1 flex-sc hidden"},bt={class:"layout-col bg-white rad8 p8"},kt={class:"ww100 flex-sc p8"},xt={class:"flex-sc fw f16 tc"},$t=["onClick"],Vt={key:0,class:"w20 h20 rad2 lh20 tc bgi13 i15 b20 l50 absolute"},At={class:"mb5"},Ct={class:"flex-ec flex1"},Nt={class:"table flex-sc warp"},St={class:"ww100 bs bo-i16-1 relative rad8"},Et={class:"ww100 flex-sc p12 bob-ce-1"},Ut={class:"f15"},It={class:"flex1 flex-ec"},qt=["onClick"],Mt={class:"ww100 flex-col p12 c6"},Tt={class:"ww100 flex-sc"},Bt={class:"ww100 flex-sc mt10"},Yt={class:"ww100 flex-sc mt10"},Ot={class:"ww100 flex-sc mt10"},Rt={class:"ww100 flex-sc mt10"},Dt={class:"ww100 flex-sc mt10"},Pt={class:"flex-sc flex1"},jt=["onClick"],zt=L({__name:"m1",setup(Ft){const{proxy:m}=K(),y=m.publicStore(),g=m.configStore(),I=m.dictStore();G();const s=H({...y.$state,click:!1,clickArr:[],provinces:[],province:"",citys:[],city:"",types:[{type:"actionReserve",name:"待审核",path:"/actionReserve"},{type:"actionReserve1",name:"已储备",path:"/actionReserve1"}],type:"actionReserve",stage:"",task_type:"",search:""}),V=[{value1:"0",value:"5000",name:"5000万以下"},{value1:"5000",value:"10000",name:"5000万-1亿"},{value1:"10000",value:"100000",name:"1亿-10亿"},{value1:"100000",value:"300000",name:"10亿-30亿"},{value1:"300000",value:"10000000",name:"30亿以上"}];J(async()=>{await B(),O(),A()});const B=async()=>{s.provinces=[{name:g.user.province_name,value:g.user.province}],s.province=s.provinces[0].value;let n=g.user.parent_id=="0"?{model:"t_station",args:`parent_id='${g.user.station_num}'`}:{model:"t_station",args:`id='${g.user.station_num}'`},e=await y.http({Api:n}),o=m.isNull(e)?[]:e.sort((i,r)=>i.order-r.order);s.citys=o.map(i=>({name:i.station_name,value:i.city})),!m.isNull(s.citys)&&g.user.parent_id!="0"&&(s.city=s.citys[0].value)},A=async n=>{let e="t_project_report",o="apply_status = '1' and reserve_status ='0'",i="apply_status = '1' and reserve_status ='1'",r={model:e,args:o};if(Y({model:e,field:"COUNT(*)",args:i}),s.province){if(r.args+=` and province='${s.province}'`,s.city&&(r.args+=` and city='${s.city}'`),!m.isNull(s.construct_datetime)){const[p,S]=s.construct_datetime;r.args+=` and construct_datetime_start>='${p}' and construct_datetime_end<='${S}'`}if(s.construct_price){let p=V.find(S=>S.value==s.construct_price);r.args+=` and construct_price>='${p.value1}' and construct_price<='${p.value}'`}s.stage&&(r.args+=` and stage='${s.stage}'`),s.task_type&&(r.args+=` and task_type='${s.task_type}'`),s.search&&(r.args+=` and name LIKE '%${s.search}%'`)}let C={limit:s.limit,page:s.page},N={field:"COUNT(*)"},x={},$={};Object.assign(x,r,C),Object.assign($,r,N);let t=await y.http({Api1:x,Api2:$});s.total=m.isNull(t.Api2)?0:t.Api2[0]["COUNT(*)"];let _=s.types.find(p=>p.type==s.type);_.total=s.total,s.empty=!!m.isNull(t.Api1),s.list=m.isNull(t.Api1)?[]:t.Api1,s.list.forEach(p=>{p.area=(p.province_name||"")+(p.city_name?`-${p.city_name}`:"")+(p.district_name?`-${p.district_name}`:"")}),R(),D()},Y=n=>{y.http({Api:n}).then(e=>{s.types[1].total=m.isNull(e)?0:e[0]["COUNT(*)"]})},O=()=>{let n={model:"t_task_type",args:"parent_id!='0'"};y.http({Api:n}).then(e=>{s.task_typess=m.isNull(e)?[]:e})},R=()=>{let n=s.list.filter(i=>i.completion_status=="1"),e=s.list.filter(i=>i.completion_status=="2"),o={sum:s.list.length,completion_status1:n.length,completion_status2:e.length};y._public.percent=o.sum?Math.floor(o.completion_status2/o.sum*100)/100:0,y._public.data1=o},D=async()=>{const n=new Map;s.list.forEach(e=>{const o=e.city_name;if(!o)return;n.has(o)||n.set(o,{area:0,impl:0});const i=e.completion_status;i==="1"?n.get(o).area++:i==="2"&&n.get(o).impl++}),y._public.responses=[{name:"谋划中项目",data:Array.from(n).map(([e,o])=>[e,String(o.area)])},{name:"实施中项目",data:Array.from(n).map(([e,o])=>[e,String(o.impl)])}]},q=(n,e)=>{n=="remind"&&lt.confirm("是否确定提醒?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{if(s.list.findIndex(i=>i.click)==-1)return T({title:"提示",message:"请选择至少一个",type:"error"});T({title:"提示",message:"提醒成功",type:"success"})}),n=="selectAll"&&(s.list.findIndex(i=>i.click)==-1?(s.click=!0,s.list.forEach(i=>{i.click=!0,s.clickArr.push(i)})):(s.click=!1,s.clickArr=[],s.list.forEach(i=>{delete i.click})))};return(n,e)=>{const o=Q,i=X,r=W,M=Z,C=F,N=z,x=j,$=P;return c(),d("div",it,[f(N,{title:""},{"left-content":w(()=>[l("div",nt,[l("div",ot,[e[12]||(e[12]=l("span",{class:"mr10"},"项目周期",-1)),l("span",ct,[f(o,{style:{width:"100%"},modelValue:a(s).construct_datetime,"onUpdate:modelValue":e[0]||(e[0]=t=>a(s).construct_datetime=t),"start-placeholder":"开始周期","end-placeholder":"结束周期",type:"yearrange","value-format":"YYYY",format:"YYYY"},null,8,["modelValue"])])]),l("div",rt,[e[13]||(e[13]=l("span",{class:"mr10"},"所属行政",-1)),l("span",pt,[f(r,{modelValue:a(s).province,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).province=t),placeholder:"请选择",style:{width:"100%"},filterable:""},{default:w(()=>[(c(!0),d(v,null,h(a(s).provinces,(t,_)=>(c(),b(i,{key:t.value,value:String(t.value),label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",dt,[e[14]||(e[14]=l("span",{class:"mr10"},"所属地市",-1)),l("span",ut,[f(r,{modelValue:a(s).city,"onUpdate:modelValue":e[2]||(e[2]=t=>a(s).city=t),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:a(g).user.parent_id=="0"},{default:w(()=>[(c(!0),d(v,null,h(a(s).citys,(t,_)=>(c(),b(i,{key:t.value,value:String(t.value),label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","clearable"])])]),l("div",mt,[e[15]||(e[15]=l("span",{class:"mr10"},"项目阶段",-1)),l("span",_t,[f(r,{modelValue:a(s).stage,"onUpdate:modelValue":e[3]||(e[3]=t=>a(s).stage=t),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{default:w(()=>[(c(!0),d(v,null,h(a(I).project_stages,(t,_)=>(c(),b(i,{key:t.value,value:String(t.value),label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",ft,[e[16]||(e[16]=l("span",{class:"mr10"},"项目类型",-1)),l("span",yt,[f(r,{modelValue:a(s).task_type,"onUpdate:modelValue":e[4]||(e[4]=t=>a(s).task_type=t),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{default:w(()=>[(c(!0),d(v,null,h(a(s).task_typess?a(s).task_typess:[],(t,_)=>(c(),b(i,{key:t.id,value:String(t.id),label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",gt,[e[17]||(e[17]=l("span",{class:"mr10"},"投资金额",-1)),l("span",wt,[f(r,{modelValue:a(s).construct_price,"onUpdate:modelValue":e[5]||(e[5]=t=>a(s).construct_price=t),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{default:w(()=>[(c(!0),d(v,null,h(V||[],(t,_)=>(c(),b(i,{key:t.value,value:String(t.value),label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),l("div",vt,[e[18]||(e[18]=l("span",{class:"mr10"},"项目名称",-1)),l("span",ht,[f(M,{modelValue:a(s).search,"onUpdate:modelValue":e[6]||(e[6]=t=>a(s).search=t),style:{width:"100%"},placeholder:"请输入"},null,8,["modelValue"])])]),l("div",{class:"rad4 ptb6 plr12 flex-cc cursor bgi1 white mt10",onClick:e[7]||(e[7]=k(t=>A(),["stop"]))},[f(C,{class:"f12 fw"}),e[19]||(e[19]=l("span",{class:"f14 ml5"},"搜索",-1))])])]),"right-content":w(()=>[...e[20]||(e[20]=[])]),_:1}),l("div",bt,[l("div",kt,[l("div",xt,[(c(!0),d(v,null,h(a(s).types,(t,_)=>(c(),d("div",{class:"mr40 cursor flex-col-cc relative",key:_,onClick:k(p=>n.toPath(t.path),["stop"])},[t.total?(c(),d("span",Vt,u(t.total),1)):E("",!0),l("span",At,u(t.name),1),l("span",{class:U(["ww100 h3 rad10",t.type==a(s).type?"bgi2":"black-rgba0"])},null,2)],8,$t))),128))]),l("div",Ct,[l("div",{class:"rad4 ptb5 plr12 flex-cc cursor bg-white c8 bo-cc-1 ml15",onClick:e[8]||(e[8]=k(t=>q("selectAll"),["stop"]))},"全选"),l("div",{class:"rad4 ptb5 plr12 flex-cc cursor bgi1 white bo-i1-1 ml15",onClick:e[9]||(e[9]=k(t=>q("remind"),["stop"]))},"提醒")])]),l("div",Nt,[(c(!0),d(v,null,h(a(s).list,(t,_)=>(c(),d("div",{class:"ww25 cursor p8",key:_},[l("div",St,[l("div",Et,[l("span",Ut,u(t.name),1),l("span",It,[t.completion_status?(c(),d("span",{key:0,class:U(["rad3 ptb3 plr6",t.completion_status=="1"?"bgi10 bo-i11-1 i12":"bgi13 bo-i14-1 i15"])},u(n.find(a(I).completion_statuss,["value",t.completion_status],"name")),3)):E("",!0),l("span",{class:U(["w18 h18 tc lh18 rad3 ml10 white f12",t.click?"bgi1 bo-i1-1":"bo-cc-1"]),onClick:k(p=>t.click=!t.click,["stop"])},[t.click?(c(),b(x,{key:0})):E("",!0)],10,qt)])]),l("div",Mt,[l("div",Tt,[e[21]||(e[21]=l("span",{class:"w110"},"所属地区",-1)),l("span",null,u(t.province_name?t.province_name:"")+u(t.city_name?`-${t.city_name}`:"")+u(t.district_name?`-${t.district_name}`:""),1)]),e[27]||(e[27]=tt('<div class="ww100 flex-sc mt10" data-v-f63a0ee9><span class="w110" data-v-f63a0ee9>征资条件</span><span class="flex-sc i12" data-v-f63a0ee9><svg xmlns="http://www.w3.org/2000/svg" class="success-icon svg-icon-path-icon fill" viewBox="0 0 32 32" width="13" height="13" data-v-f63a0ee9><defs data-v-f63a0ee9></defs><g data-v-f63a0ee9><path d="M29.333 26.667h-26.667v-2.667h1.333v-9.292c0-6.651 5.373-12.041 12-12.041s12 5.391 12 12.041v9.292h1.333v2.667zM12.667 28h6.667c0 1.841-1.492 3.333-3.333 3.333s-3.333-1.492-3.333-3.333v0z" data-v-f63a0ee9></path></g></svg><span class="ml5" data-v-f63a0ee9>符合</span></span></div>',1)),l("div",Bt,[e[22]||(e[22]=l("span",{class:"w110"},"项目周期",-1)),l("span",null,u(t.construct_datetime_start&&t.construct_datetime_end?`${t.construct_datetime_start}-${t.construct_datetime_end}`:"-"),1)]),l("div",Yt,[e[23]||(e[23]=l("span",{class:"w110"},"项目规模",-1)),l("span",null,u(t.construct_scale?`${t.construct_scale}`:"-"),1)]),l("div",Ot,[e[24]||(e[24]=l("span",{class:"w110"},"预估投入",-1)),l("span",null,u(t.construct_price?`${t.construct_price} 万元`:"-"),1)]),l("div",Rt,[e[25]||(e[25]=l("span",{class:"w110"},"项目性质",-1)),l("span",null,u(t.construct_nature?n.decrypt(t.construct_nature):"-"),1)]),l("div",Dt,[l("div",Pt,[e[26]||(e[26]=l("span",{class:"w110"},"更新进度时间",-1)),l("span",null,u(t.update_time?n.parseTime(t.update_time):"-"),1)]),l("div",{class:"rad5 ptb5 plr12 cursor bgi1 white",onClick:k(p=>n.toPath("/actionApply",{id:t.id}),["stop"])},"审批",8,jt)])])])]))),128))]),et(f($,{class:"",style:{"padding-bottom":"0"},total:a(s).total,page:a(s).page,"onUpdate:page":e[10]||(e[10]=t=>a(s).page=t),pageModifiers:{sync:!0},limit:a(s).limit,"onUpdate:limit":e[11]||(e[11]=t=>a(s).limit=t),limitModifiers:{sync:!0},onPagination:A},null,8,["total","page","limit"]),[[st,a(s).total>0]])])])}}}),Wt=at(zt,[["__scopeId","data-v-f63a0ee9"]]);export{Wt as default};
