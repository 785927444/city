import{_ as q}from"./Pagination.vue_vue_type_style_index_0_lang-CMYQ1dta.js";import{_ as j}from"./check-BI2Kx_Kg.js";import{_ as O}from"./AaTitle.vue_vue_type_script_setup_true_lang-Dok3GIN-.js";import{_ as P}from"./filter-CFoa9Riw.js";import{d as R,g as M,aa as T,r as D,b as z,o as c,c as _,a as u,w as g,f as e,B as F,u as a,A as L,F as x,q as k,x as $,z as K,E as G,e as y,t as d,p as S,h as H,k as J,v as Q,ac as W,a8 as I,l as X}from"./index-BWjCSAnw.js";import"./el-pagination-20-n38jk.js";const Z={class:"layout-col"},tt={class:"flex-sc mr30"},et={class:"w50x4"},st={class:"flex-sc mr30"},lt={class:"w50x3"},at={class:"flex-sc mr30"},nt={class:"w50x3"},it={class:"flex-sc mr15"},ot={class:"w50x3"},ct={class:"flex-sc mr15"},rt={class:"w50x3"},pt={class:"layout-col bg-white rad8 p8"},dt={class:"ww100 flex-sc p8"},ut={class:"flex-sc fw f16 tc"},mt=["onClick"],_t={class:"mb5"},ft={class:"flex-ec flex1"},wt={class:"table flex-sc warp"},yt={class:"ww100 bs bo-i16-1 relative rad8"},gt={class:"ww100 flex-sc p12 bob-ce-1"},xt={class:"f15"},kt={class:"flex1 flex-ec"},bt=["onClick"],ht={class:"ww100 flex-col p12 c6"},vt={class:"ww100 flex-sc"},$t={class:"ww100 flex-sc mt10"},Vt={class:"ww100 flex-sc mt10"},At={class:"ww100 flex-sc mt10"},Ct={class:"ww100 flex-sc mt10"},Nt={class:"ww100 flex-sc mt10"},Et={class:"ww100 flex-sc mt10"},St={class:"flex-sc flex1"},It=["onClick"],Ut=R({__name:"index",setup(Bt){const{proxy:r}=M(),V=r.publicStore(),m=r.configStore(),U=r.dictStore();T();const B=[{type:"actionRelease",name:"已上报",path:"/actionRelease"},{type:"actionApply",name:"已申请",path:"/actionApply"},{type:"actionReturn",name:"已退回",path:"/actionReturn"}],l=D({...V.$state,click:!1,clickArr:[],provinces:[],province:"",citys:[],city:"",type:"actionRelease",completion_status:"1",search:"",schemeAreas:[{value:"1",name:"龙城片区"}]});z(async()=>{await Y(),A()});const Y=async()=>{l.provinces=[{name:m.user.province_name,value:m.user.province}],l.province=l.provinces[0].value;let o=m.user.parent_id=="0"?{model:"t_station",args:`parent_id='${m.user.station_num}'`}:{model:"t_station",args:`id='${m.user.station_num}'`},s=await V.http({Api:o}),f=r.isNull(s)?[]:s.sort((n,w)=>n.order-w.order);l.citys=f.map(n=>({name:n.station_name,value:n.city})),!r.isNull(l.citys)&&m.user.parent_id!="0"&&(l.city=l.citys[0].value)},A=async o=>{let p={model:"t_scheme_project p",field:"p.*, sp.name as schemeName, sp.parent_area",join:"t_scheme_plan sp ON p.scheme_id = sp.id",args:"sp.release_status = '1'"};if(l.province){if(p.args+=` and sp.province='${l.province}'`,l.city&&(p.args+=` and sp.city='${l.city}'`),!r.isNull(l.construct_datetime)){const[i,v]=l.construct_datetime;p.args+=` and p.construct_datetime_start>='${i}' and p.construct_datetime_end<='${v}'`}l.completion_status&&(p.args+=` and p.completion_status='${l.completion_status}'`),l.search&&(p.args+=` and p.name LIKE '%${l.search}%'`)}let C={limit:l.limit,page:l.page},N={field:"COUNT(*)"},b={},h={};Object.assign(b,p,C),Object.assign(h,p,N);let t=await V.http({Api1:b,Api2:h});l.total=r.isNull(t.Api2)?0:t.Api2[0]["COUNT(*)"],l.empty=!!r.isNull(t.Api1),l.list=r.isNull(t.Api1)?[]:t.Api1,l.list.forEach(i=>{i.area=(i.province_name||"")+(i.city_name?`-${i.city_name}`:"")+(i.district_name?`-${i.district_name}`:"")})},E=(o,s)=>{o=="remind"&&W.confirm("是否确定提醒?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{if(l.list.findIndex(n=>n.click)==-1)return I({title:"提示",message:"请选择至少一个",type:"error"});I({title:"提示",message:"提醒成功",type:"success"})}),o=="selectAll"&&(l.list.findIndex(n=>n.click)==-1?(l.click=!0,l.list.forEach(n=>{n.click=!0,l.clickArr.push(n)})):(l.click=!1,l.clickArr=[],l.list.forEach(n=>{delete n.click})))};return(o,s)=>{const f=F,n=K,w=L,p=G,C=P,N=O,b=j,h=q;return c(),_("div",Z,[u(N,{title:""},{"left-content":g(()=>[e("div",tt,[s[10]||(s[10]=e("span",{class:"mr10"},"项目周期",-1)),e("span",et,[u(f,{style:{width:"100%"},modelValue:a(l).construct_datetime,"onUpdate:modelValue":s[0]||(s[0]=t=>a(l).construct_datetime=t),"start-placeholder":"开始周期","end-placeholder":"结束周期",type:"yearrange","value-format":"YYYY",format:"YYYY"},null,8,["modelValue"])])]),e("div",st,[s[11]||(s[11]=e("span",{class:"mr10"},"所属行政",-1)),e("span",lt,[u(w,{modelValue:a(l).province,"onUpdate:modelValue":s[1]||(s[1]=t=>a(l).province=t),placeholder:"请选择",style:{width:"100%"},filterable:""},{default:g(()=>[(c(!0),_(x,null,k(a(l).provinces,(t,i)=>(c(),$(n,{key:t.value,value:String(t.value),label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),e("div",at,[s[12]||(s[12]=e("span",{class:"mr10"},"所属地市",-1)),e("span",nt,[u(w,{modelValue:a(l).city,"onUpdate:modelValue":s[2]||(s[2]=t=>a(l).city=t),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:a(m).user.parent_id=="0"},{default:g(()=>[(c(!0),_(x,null,k(a(l).citys,(t,i)=>(c(),$(n,{key:t.value,value:String(t.value),label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","clearable"])])]),e("div",it,[s[13]||(s[13]=e("span",{class:"mr10"},"实施状态",-1)),e("span",ot,[u(w,{modelValue:a(l).completion_status,"onUpdate:modelValue":s[3]||(s[3]=t=>a(l).completion_status=t),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{default:g(()=>[(c(!0),_(x,null,k(a(U).project_completion_statuss,(t,i)=>(c(),$(n,{key:t.value,value:String(t.value),label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),e("div",ct,[s[14]||(s[14]=e("span",{class:"mr10"},"项目名称",-1)),e("span",rt,[u(p,{modelValue:a(l).search,"onUpdate:modelValue":s[4]||(s[4]=t=>a(l).search=t),style:{width:"100%"},placeholder:"请输入"},null,8,["modelValue"])])]),e("div",{class:"rad4 ptb6 plr12 flex-cc cursor bgi1 white",onClick:s[5]||(s[5]=y(t=>A(),["stop"]))},[u(C,{class:"f12 fw"}),s[15]||(s[15]=e("span",{class:"f14 ml5"},"搜索",-1))])]),"right-content":g(()=>[...s[16]||(s[16]=[])]),_:1}),e("div",pt,[e("div",dt,[e("div",ut,[(c(),_(x,null,k(B,(t,i)=>e("div",{class:"mr20 cursor flex-col-cc",key:i,onClick:y(v=>o.toPath(t.path),["stop"])},[e("span",_t,d(t.name),1),e("span",{class:S(["ww100 h3 rad10",t.type==a(l).type?"bgi2":"black-rgba0"])},null,2)],8,mt)),64))]),e("div",ft,[e("div",{class:"rad4 ptb5 plr12 flex-cc cursor bg-white c8 bo-cc-1 ml15",onClick:s[6]||(s[6]=y(t=>E("selectAll"),["stop"]))},"全选"),e("div",{class:"rad4 ptb5 plr12 flex-cc cursor bgi1 white bo-i1-1 ml15",onClick:s[7]||(s[7]=y(t=>E("remind"),["stop"]))},"提醒")])]),e("div",wt,[(c(!0),_(x,null,k(a(l).list,(t,i)=>(c(),_("div",{class:"ww25 cursor p8",key:i},[e("div",yt,[e("div",gt,[e("span",xt,d(t.name),1),e("span",kt,[e("span",{class:S(["w18 h18 tc lh18 rad3 ml10 white f12",t.click?"bgi1 bo-i1-1":"bo-cc-1"]),onClick:y(v=>t.click=!t.click,["stop"])},[t.click?(c(),$(b,{key:0})):H("",!0)],10,bt)])]),e("div",ht,[e("div",vt,[s[17]||(s[17]=e("span",{class:"w110"},"所属地区",-1)),e("span",null,d(t.area?t.area:""),1)]),e("div",$t,[s[18]||(s[18]=e("span",{class:"w110"},"所属片区",-1)),e("span",null,d(t.parent_area?o.find(a(l).schemeAreas,["value",t.parent_area],"name"):"-"),1)]),e("div",Vt,[s[19]||(s[19]=e("span",{class:"w110"},"项目周期",-1)),e("span",null,d(t.construct_datetime_start&&t.construct_datetime_end?`${t.construct_datetime_start}-${t.construct_datetime_end}`:"-"),1)]),e("div",At,[s[20]||(s[20]=e("span",{class:"w110"},"项目规模",-1)),e("span",null,d(t.construct_scale?`${t.construct_scale}`:"-"),1)]),e("div",Ct,[s[21]||(s[21]=e("span",{class:"w110"},"预估投入",-1)),e("span",null,d(t.construct_price?`${t.construct_price} 万元`:"-"),1)]),e("div",Nt,[s[22]||(s[22]=e("span",{class:"w110"},"项目性质",-1)),e("span",null,d(t.construct_nature?o.decrypt(t.construct_nature):"-"),1)]),e("div",Et,[e("div",St,[s[23]||(s[23]=e("span",{class:"w110"},"更新进度时间",-1)),e("span",null,d(t.rate_time?o.parseTime(t.rate_time):"-"),1)]),e("div",{class:"rad5 ptb5 plr12 cursor bgi1 white",onClick:y(v=>o.toPath("/schemePlanView",{id:t.id}),["stop"])},"申请储备",8,It)])])])]))),128))]),J(u(h,{class:"",style:{"padding-bottom":"0"},total:a(l).total,page:a(l).page,"onUpdate:page":s[8]||(s[8]=t=>a(l).page=t),pageModifiers:{sync:!0},limit:a(l).limit,"onUpdate:limit":s[9]||(s[9]=t=>a(l).limit=t),limitModifiers:{sync:!0},onPagination:A},null,8,["total","page","limit"]),[[Q,a(l).total>0]])])])}}}),Mt=X(Ut,[["__scopeId","data-v-4c12c519"]]);export{Mt as default};
