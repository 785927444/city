import{d as $,g as z,b as P,j as b,a3 as A,o as p,c as y,a as l,w as d,u as s,f as c,k as B,z as _,a6 as M,r as N,e as v,E as K,aP as S,h as T,t as U,K as D}from"./index-ClTGGYJq.js";import{v as L}from"./el-loading-WYLhAgbb.js";import{E as j}from"./el-pagination-B7EgBbn6.js";/* empty css                        *//* empty css                    */import{E as H}from"./el-image-viewer-BSQBUEyb.js";import{_ as O}from"./AaTitle.vue_vue_type_script_setup_true_lang-DQZ6AruM.js";import{a as R,E as F}from"./index-G0MRvna3.js";import"./index-CcHJUmzw.js";const G={class:"layout-col"},J={class:"flex-sc ml15"},Q={class:"white-rgba50 rad8 p15"},W={key:1,class:"i2"},X=["onClick"],Y={class:"flex-ec mt15"},pt=$({__name:"column",setup(Z){const{proxy:g}=z(),m=M(),f={policy:"政策法规",standard:"标准规范",mechanism:"工作机制",expert:"专家智库",case:"优秀案例",course:"培训课程",all:"全部专栏"},t=N({code:"all",title:"知识库专栏",q:"",page:1,limit:20,total:0,list:[],loading:!1}),x=D(()=>t.code==="expert"||t.code==="case");P(async()=>{t.code=m.params.code||"all",t.q=m.query.q||"",t.title=f[t.code]||"知识库专栏",await n(1)}),b(()=>m.params.code,async o=>{t.code=o||"all",t.title=f[t.code]||"知识库专栏",t.page=1,await n(1)}),b(()=>m.query.q,async o=>{t.q=o||"",t.page=1,await n(1)});const n=async o=>{t.page=o,t.loading=!0;try{const e={column_code:t.code==="all"?"":t.code,q:t.q,page:t.page,limit:t.limit},i=await A.kbItemsApi(e),u=i?.data??i;t.list=u?.items??[],t.total=u?.total??0}catch{t.list=[],t.total=0}finally{t.loading=!1}},k=o=>{g.toPath(`/knowledge/item/${o}`)},C=()=>{g.toPath("/knowledge")},h=o=>{const e=o?.image_urls;return Array.isArray(e)?e.map(i=>String(i)).filter(i=>i.trim()):[]},w=o=>h(o)[0]||"";return(o,e)=>{const i=K,u=O,r=F,q=H,E=R,I=j,V=L;return p(),y("div",G,[l(u,{title:s(t).title},{"left-content":d(()=>[c("div",J,[l(i,{modelValue:s(t).q,"onUpdate:modelValue":e[0]||(e[0]=a=>s(t).q=a),placeholder:"检索本专栏",clearable:"",class:"w320",onKeyup:e[1]||(e[1]=S(a=>n(1),["enter"]))},null,8,["modelValue"]),c("div",{class:"rad4 ptb5 w80 flex-cc cursor bgi1 white ml10",onClick:e[2]||(e[2]=v(a=>n(1),["stop"]))},"查询")])]),"right-content":d(()=>[c("div",{class:"rad4 ptb5 plr8 flex-cc cursor bgi1 white ml10",onClick:e[3]||(e[3]=v(a=>C(),["stop"]))},"首页")]),_:1},8,["title"]),c("div",Q,[B((p(),_(E,{data:s(t).list,stripe:""},{default:d(()=>[l(r,{type:"index",width:"60",label:"#"}),s(x)?(p(),_(r,{key:0,label:"预览",width:"120"},{default:d(({row:a})=>[w(a)?(p(),_(q,{key:0,src:w(a),"preview-src-list":h(a),"initial-index":0,fit:"cover",style:{width:"90px",height:"54px","border-radius":"4px"}},null,8,["src","preview-src-list"])):(p(),y("span",W,"-"))]),_:1})):T("",!0),l(r,{prop:"title",label:"标题","min-width":"320"},{default:d(({row:a})=>[c("span",{class:"cursor i1",onClick:tt=>k(a.id)},U(a.title),9,X)]),_:1}),l(r,{prop:"publish_org",label:"发布单位",width:"160"}),l(r,{prop:"doc_no",label:"文号/编号",width:"180"}),l(r,{prop:"publish_time",label:"发布时间",width:"140"}),l(r,{prop:"views",label:"浏览",width:"100"})]),_:1},8,["data"])),[[V,s(t).loading]]),c("div",Y,[l(I,{background:"",layout:"total, prev, pager, next, sizes",total:s(t).total,"page-size":s(t).limit,"current-page":s(t).page,onCurrentChange:e[4]||(e[4]=a=>n(a)),onSizeChange:e[5]||(e[5]=a=>{s(t).limit=a,n(1)})},null,8,["total","page-size","current-page"])])])])}}});export{pt as default};
