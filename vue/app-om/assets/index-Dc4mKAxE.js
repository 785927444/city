import{_ as z}from"./Add-CEL0KAmB.js";import{_ as B}from"./AaFoot-DEQbEpoG.js";import{d as U,g as M,r as R,b as T,j as O,o as a,c as o,a as h,w as G,f as b,u as l,e as x,_ as H,t as y,h as A,F as g,p as I,k as P,v as E,y as k,x as $,E as J,z as K,i as Q,n as W}from"./index-Bd85TTIS.js";import{E as X}from"./el-image-viewer-M0JIGJ1W.js";import{E as Y}from"./el-switch-Cn5LjBBU.js";import{_ as Z}from"./AaTitle.vue_vue_type_script_setup_true_lang-DNddMUg2.js";/* empty css                    */import"./index-DXutnob0.js";import"./Upload-CO9VUP-R.js";/* empty css                   */import"./index-DDNRsVXm.js";import"./el-text-CZU5bItM.js";import"./index-CLnax6KY.js";/* empty css                    */const ee={class:"layout-col"},te={class:"flex-ec flex1"},se={class:"f14 ml4"},ae={class:"layout-col ba1"},ie={class:"row bgi22"},oe={class:"table"},le=["onClick"],ne=["onClick"],re={key:1},ce={key:2},de={key:4},ue={key:5},pe={key:6},ye={key:7,class:"flex-sc warp"},me={key:0,class:"flex-sc"},_e={key:1,class:"w50 h25 ca flex-sc"},he={key:8},ke={key:0,class:"flex-cc ww100 tc ptb13 bgi18"},je=U({__name:"index",setup(fe){const{proxy:m}=M(),r=m.publicStore(),c=m.configStore();let C=Q();const s=R({...r.$state,content:[{width:"w70",show:!0,align:"center",key:"*",name:"序号"},{width:"w50x5",show:!0,align:"left",key:"id",name:"ID",type:"icon5"},{width:"w50x5",show:!0,align:"left",key:"name",name:"名称"},{width:"w50x5",show:!0,align:"left",key:"type",name:"类型",list:[],value:"type",label:"name"},{width:"w50x5",show:!0,align:"left",key:"localSvcIP",name:"IP/串口号"},{width:"w50x5",show:!0,align:"left",key:"localSvcPort",name:"端口/波特率"},{width:"w50x2",show:!0,align:"left",key:"order",name:"排序"},{width:"flex1",show:!0,align:"right",key:{},name:"操作"}],editFrom:[],addItem:{},model:"t_sensor"});T(async()=>{r.init({path:"/sensor"},s),c.distributId||(c.distributId="0");let _={Api1:{model:"t_station",args:"parent_id='0'"},Api2:{model:"t_sensor_template",args:"attribute='2'"}},p=await r.http(_);r._public.stations=m.isNull(p.Api1)?[]:p.Api1.sort((f,v)=>f.order-v.order),r._public.templates=m.isNull(p.Api2)?[]:p.Api2,S()}),O(()=>c.distributId,async(i,n)=>{await W(),!m.isNull(i)&&S()},{immediate:!1,deep:!0});const S=async i=>{let n=!c.distributId||c.distributId=="0"?"class=2":`stationNum='${c.distributId}' and class=2`;n=c.user&&c.user.role_id=="1"?n:n+" and id > 0",s.query={model:s.model,args:n},s.params={Api:s.query};let _=await r.http(s.params);s.empty=!!m.isNull(_),s.list=m.isNull(_)?[]:_.sort((p,f)=>p.order-f.order),r._public.list=s.list,j()},j=()=>{!c.distributId||c.distributId=="0"?(s.addItem={parent_id:"0",class:"2"},s.editFrom=[{required:!0,editshow:!0,name:"厂站",key:"stationNum",type:"select",list:r._public.stations,value:"id",label:"station_name"},{required:!0,editshow:"disabled",name:"ID",key:"id",type:"input",class:"number"},{required:!0,editshow:!0,name:"名称",key:"name",type:"input"},{required:!0,editshow:!0,name:"类型",key:"type",type:"select",list:[],value:"type",label:"name",relation:["comm_params"]},{required:!1,editshow:!0,name:"IP/串口号",key:"localSvcIP",type:"input"},{required:!1,editshow:!0,name:"端口/波特率",key:"localSvcPort",type:"input"},{required:!1,editshow:!0,name:"排序",key:"order",type:"input"},{required:!1,editshow:!0,name:"通信参数",key:"comm_params",type:"json"}]):(s.addItem={stationNum:c.distributId,parent_id:"0",class:"2"},s.editFrom=[{required:!0,editshow:"disabled",name:"ID",key:"id",type:"input",class:"number"},{required:!0,editshow:!0,name:"名称",key:"name",type:"input"},{required:!0,editshow:!0,name:"类型",key:"type",type:"select",list:[],value:"type",label:"name",relation:["comm_params"]},{required:!1,editshow:!0,name:"IP/串口号",key:"localSvcIP",type:"input"},{required:!1,editshow:!0,name:"端口/波特率",key:"localSvcPort",type:"input"},{required:!1,editshow:!0,name:"排序",key:"order",type:"input"},{required:!1,editshow:!0,name:"通信参数",key:"comm_params",type:"json"}]),s.content.forEach(i=>{i.key=="type"&&(i.list=r._public.templates)}),s.editFrom.forEach(i=>{i.key=="type"&&(i.list=r._public.templates)})},q=(i,n)=>{(i=="add"||i=="upd")&&C.value.onVisable(n),i=="del"&&C.value.del(n)};return(i,n)=>{const _=H,p=Z,f=Y,v=J,N=X,L=B,F=z;return a(),o("div",ee,[h(p,{title:"前置"},{"right-content":G(()=>[b("div",te,[l(s).content.find(t=>typeof t.key=="object")&&l(s).content.find(t=>typeof t.key=="object").key.hasOwnProperty("add")?(a(),o("div",{key:0,class:"rad4 ptb5 plr8 flex-cc cursor bgi22 i21 ml10 bo-i21-1",onClick:n[0]||(n[0]=x(t=>q("add",l(s).addItem),["stop"]))},[h(_,{class:"f12 fw"}),b("span",se,y(l(s).content.find(t=>typeof t.key=="object").key.add),1)])):A("",!0)])]),_:1}),b("div",ae,[b("div",ie,[(a(!0),o(g,null,I(l(s).content,(t,w)=>P((a(),o("div",{style:$({textAlign:t.align}),key:w,class:k(typeof t.key=="object"?t.width+" mlr5":t.width)},y(t.name),7)),[[E,t.show]])),128))]),b("div",oe,[(a(!0),o(g,null,I(l(s).list,(t,w)=>(a(),o("div",{class:k(["row cursor",l(r).active[l(s).key]==t[l(s).key]?"active":w%2==1?"bgi23":"bgi18"]),key:w,onClick:e=>q("active",t)},[(a(!0),o(g,null,I(l(s).content,(e,D)=>P((a(),o("div",{class:k(e.width),style:$({textAlign:e.align}),key:D},[typeof e.key=="object"?(a(!0),o(g,{key:0},I(e.key,(d,u,V)=>(a(),o("span",{class:k(["cursor mlr5",u=="sensorcontrol"||u=="sensoralarm"||u=="sensorset"||u=="add"||l(s).auth[u]==!1?"none":u=="del"?"i8":"i21"]),key:V,onClick:x(we=>q(u,t),["stop"])},y(d),11,ne))),128)):e.key=="*"?(a(),o("span",re,y((l(s).page-1)*l(s).limit+w+1),1)):e.type=="time"?(a(),o("span",ce,y(t[e.key]==0?"/":i.parseTime(t[e.key])),1)):e.type=="select"?(a(),o("span",{key:3,class:k(i.find(e.list,[e.value,t[e.key]],"color")?i.find(e.list,[e.value,t[e.key]],"color"):"")},y(i.find(e.list,[e.value,t[e.key]],e.label)),3)):e.type=="switch"?(a(),o("span",de,[h(f,{modelValue:t[e.key],"onUpdate:modelValue":d=>t[e.key]=d,"active-text":e.value[1].name,"inactive-text":e.value[0].name,"active-value":e.value[1].value,"inactive-value":e.value[0].value,"inline-prompt":"",onChange:d=>q("switch",t)},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","active-value","inactive-value","onChange"])])):e.type=="input"?(a(),o("span",ue,[h(v,{modelValue:t[e.value],"onUpdate:modelValue":d=>t[e.value]=d,placeholder:"请输入",style:{width:"150px"},size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):e.type=="preload"&&e.filed?(a(),o("span",pe,y(t[e.key]?t[e.key][e.filed]:""),1)):e.type=="image"?(a(),o("span",ye,[typeof t[e.key]=="string"?(a(),o("div",me,[t[e.key].length!=0?(a(),K(N,{key:0,class:"w25 h25 m2 rad3 cursor",src:i.I(t[e.key]),"preview-src-list":l(s).srcList,onClick:x(d=>{l(s).srcList=[],l(s).srcList.push(i.I(t[e.key]))},["stop"])},null,8,["src","preview-src-list","onClick"])):(a(),o("span",_e,"暂无"))])):(a(!0),o(g,{key:1},I(t[e.key],(d,u)=>(a(),o("div",{class:"flex-sc",key:u},[h(N,{class:k([u==0?"":"ml5","w25 h25 rad3 cursor"]),src:i.I(d),"preview-src-list":l(s).srcList,onClick:x(V=>{l(s).srcList=[],l(s).srcList.push(i.I(d))},["stop"])},null,8,["class","src","preview-src-list","onClick"])]))),128))])):(a(),o("span",he,y(i.isNull(t[e.key])&&e.key!=""?"/":t[e.key]),1))],6)),[[E,e.show]])),128))],10,le))),128)),l(s).empty?(a(),o("div",ke,"没有数据")):A("",!0)])]),h(L),h(F,{onInit:S,state:l(s),ref_key:"addRef",ref:C},null,8,["state"])])}}});export{je as default};
