import{_ as x}from"./Add-BFaa3Kc7.js";import{_ as C}from"./Pagination.vue_vue_type_style_index_0_lang-CjUCoIAl.js";import{_ as q}from"./List.vue_vue_type_script_setup_true_lang-Lnm6dwtK.js";import{_ as A}from"./AaTitle.vue_vue_type_script_setup_true_lang-BA3Fb0N5.js";import{d as I,g as N,r as V,j as $,o as y,c as g,a as r,w,u as i,e as h,_ as S,f as u,t as j,h as O,E as U,k as E,v as B,i as M,n as P,l as T}from"./index-CymMRwSV.js";import"./el-progress-BEBGOLgq.js";import"./Upload-ByV2V8PN.js";import"./el-message-BtiibD_d.js";import"./el-text-CYsroQ47.js";import"./el-checkbox-DcAGyG1S.js";import"./el-pagination-Dn7oVmkx.js";import"./el-image-viewer-_li9ZGN2.js";import"./el-switch-DPAET1bd.js";import"./select-jKvYibgS.js";const D={class:"layout-col"},L={class:"flex-sc"},R={class:"f14 ml2"},F={class:"layout-col bg-white rad8 p15"},H=I({__name:"m2",setup(K){const{proxy:a}=N(),l=a.publicStore();a.configStore(),a.dictStore();let p=M();const e=V({...l.$state,content:[{width:"w60",show:!0,align:"center",key:"*",name:"序号"},{width:"flex1",show:!0,align:"left",key:"name",name:"问题指标项"},{width:"w50x4",show:!0,align:"center",key:"unit",name:"量化单位"},{width:"w50x4",show:!0,align:"right",key:{view:"查看"},name:"操作"}],editFrom:[{required:!0,editshow:"none",name:"上级",key:"parent_id",type:"input"},{required:!0,editshow:!0,name:"问题指标项",key:"name",type:"input"},{required:!0,editshow:!0,name:"量化单位",key:"unit",type:"input"},{required:!1,editshow:!0,name:"所属维度",key:"type",type:"input"},{required:!1,editshow:!0,name:"排序",key:"orderd",type:"input"}],addItem:{},model:"t_task_problem"});$(()=>l.active,async o=>{a.isNull(o)||(await P(),e.addItem={parent_id:o.id,type:o.type},await k(),d())},{immediate:!1,deep:!0});const k=async()=>{},d=async o=>{let t={model:e.model,args:`parent_id='${l.active.id}'`,order:"orderd ASC"};e.search&&(t.args+=` and name LIKE '%${e.search}%'`);let _={limit:e.limit,page:e.page},f={field:"COUNT(*)"},c={},m={};Object.assign(c,t,_),Object.assign(m,t,f);let s=await l.http({Api1:c,Api2:m});e.empty=!!a.isNull(s.Api1),e.list=a.isNull(s.Api1)?[]:s.Api1,e.total=a.isNull(s.Api2)?0:s.Api2[0]["COUNT(*)"]},b=async(o,t)=>{(o=="add"||o=="upd")&&p.value.onVisable(t),o=="del"&&p.value.del(t)};return(o,t)=>{const _=U,f=S,c=A,m=q,s=C,v=x;return y(),g("div",D,[r(c,{title:""},{"left-content":w(()=>[u("div",L,[r(_,{modelValue:i(e).search,"onUpdate:modelValue":t[0]||(t[0]=n=>i(e).search=n),placeholder:"请输入"},null,8,["modelValue"]),u("div",{class:"rad4 ptb5 w80 flex-cc cursor bgi1 white ml10",onClick:t[1]||(t[1]=h(n=>{i(e).page=1,d()},["stop"]))},"搜索")])]),"right-content":w(()=>[i(e).content.find(n=>typeof n.key=="object")&&i(e).content.find(n=>typeof n.key=="object").key.hasOwnProperty("add")?(y(),g("div",{key:0,class:"rad4 ptb5 plr8 flex-cc cursor bgi1 white ml10",onClick:t[2]||(t[2]=h(n=>i(p).onVisable(i(e).addItem),["stop"]))},[r(f,{class:"f12 fw"}),u("span",R,j(i(e).content.find(n=>typeof n.key=="object").key.add),1)])):O("",!0)]),_:1}),u("div",F,[r(m,{onHandleClick:b,state:i(e)},null,8,["state"]),E(r(s,{class:"",style:{"padding-bottom":"0"},total:i(e).total,page:i(e).page,"onUpdate:page":t[3]||(t[3]=n=>i(e).page=n),pageModifiers:{sync:!0},limit:i(e).limit,"onUpdate:limit":t[4]||(t[4]=n=>i(e).limit=n),limitModifiers:{sync:!0},onPagination:d},null,8,["total","page","limit"]),[[B,i(e).total>0]])]),r(v,{onInit:d,state:i(e),ref_key:"addRef",ref:p},null,8,["state"])])}}}),se=T(H,[["__scopeId","data-v-ef7b5114"]]);export{se as default};
