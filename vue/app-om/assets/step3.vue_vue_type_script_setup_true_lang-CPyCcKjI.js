import{d as M,g as N,b as D,j as R,o as k,c as x,f as i,a as t,Z as z,u as s,w as n,e as m,i as _,$ as K,m as O,q as P,E as Z,F as G,p as H,y as J,t as Q,r as y,K as W,a9 as h,a4 as U}from"./index-ClTGGYJq.js";import{_ as X}from"./FileList.vue_vue_type_script_setup_true_lang-Bn2Vhi25.js";/* empty css                        *//* empty css                    */import{a as Y,E as ee}from"./index-G0MRvna3.js";const te={class:"layout-col overlay"},le={class:"hh100 ww100 flex-sc warp"},oe={class:"flex-sc warp ww100"},se={class:"ww100 flex-sc pb20"},ae=["onClick"],ne={class:"ww100 flex-cc f18 p40 bot-i16-1 mt20"},me=M({__name:"step3",setup(re){const{proxy:v}=N(),o=v.publicStore(),b=_(),C={project_status:[{required:!0,message:"请选择",trigger:"change"}],invested_amount:[{required:!0,message:"请输入",trigger:"blur"}],constructed_scale:[{required:!0,message:"请输入",trigger:"blur"}]},g=[{value:"1",name:"重点落实任务"},{value:"2",name:"体检整改任务"}],f=_(g[0]),E=y({id:"process-files"}),T=y({id:"effect-files"}),S=_([{id:"process-file-1",parent_id:"process-files",name:"过程材料",type:"process_file"}]),j=_([{id:"effect-file-1",parent_id:"effect-files",name:"实施成效",type:"effect_file"}]),B=a=>({id:`${a}-${Date.now()}`,task_type:a,task_name:"",construction_content:"",project_goal:"",completed_goal:""}),w=a=>{Array.isArray(o.form.progress_tasks)||(o.form.progress_tasks=[]),o.form.progress_tasks.some(u=>String(u.task_type)===String(a))||o.form.progress_tasks.push(B(a))},$=W(()=>(Array.isArray(o.form.progress_tasks)?o.form.progress_tasks:[]).filter(l=>String(l.task_type)===String(f.value.value)));D(()=>{o.form.process_files||(o.form.process_files={}),o.form.effect_files||(o.form.effect_files={}),w(f.value.value)}),R(()=>f.value.value,a=>{w(a)});const A=a=>{a&&a.validate(l=>{l&&h.confirm("是否确定保存?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{U({title:"提示",message:"保存成功",type:"success"})})})},F=a=>{a&&a.validate(l=>{l&&h.confirm("是否确定提交?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warn"}).then(()=>{U({title:"提示",message:"提交成功",type:"success"}),v.toPath("/project-push")})})};return(a,l)=>{const u=P,q=O,c=K,p=Z,d=ee,I=Y,V=X,L=z;return k(),x("div",te,[i("div",le,[t(L,{class:"ww100 pplr15",ref_key:"formRef",ref:b,model:s(o).form,rules:C,"label-width":"120"},{default:n(()=>[i("div",oe,[t(c,{label:"项目状态",prop:"project_status",class:"ww50 flex-sc"},{default:n(()=>[t(q,{modelValue:s(o).form.project_status,"onUpdate:modelValue":l[0]||(l[0]=e=>s(o).form.project_status=e),placeholder:"请选择",style:{width:"100%"}},{default:n(()=>[t(u,{label:"实施中",value:"实施中"}),t(u,{label:"已完成",value:"已完成"}),t(u,{label:"暂停",value:"暂停"})]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"已投资金额",prop:"invested_amount",class:"ww50 flex-sc"},{default:n(()=>[t(p,{modelValue:s(o).form.invested_amount,"onUpdate:modelValue":l[1]||(l[1]=e=>s(o).form.invested_amount=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),t(c,{label:"已建设规模",prop:"constructed_scale",class:"ww50 flex-sc"},{default:n(()=>[t(p,{modelValue:s(o).form.constructed_scale,"onUpdate:modelValue":l[2]||(l[2]=e=>s(o).form.constructed_scale=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),t(c,{label:"实施成效说明",prop:"implementation_effect",class:"ww100 flex-sc"},{default:n(()=>[t(p,{modelValue:s(o).form.implementation_effect,"onUpdate:modelValue":l[3]||(l[3]=e=>s(o).form.implementation_effect=e),type:"textarea",rows:4,placeholder:"请输入"},null,8,["modelValue"])]),_:1}),t(c,{label:"项目任务",prop:"progress_tasks",class:"ww100 flex-ss"},{default:n(()=>[i("div",se,[(k(),x(G,null,H(g,(e,r)=>i("div",{class:J(["mr40 pb10 f18 relative cursor actfont",s(f).value==e.value?"i1 bob-i1-2":"bob-tt-2"]),key:r,onClick:m(ie=>f.value=e,["stop"])},[i("span",null,Q(e.name),1)],10,ae)),64))]),t(I,{data:s($),border:"",stripe:"","header-cell-class-name":"bgi16 c3"},{default:n(()=>[t(d,{type:"index",label:"序号",align:"center",width:"60"}),t(d,{label:"中央《意见》任务名称",align:"center"},{default:n(({row:e})=>[t(p,{modelValue:e.task_name,"onUpdate:modelValue":r=>e.task_name=r,placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{label:"涉及的重点建设内容",align:"center"},{default:n(({row:e})=>[t(p,{modelValue:e.construction_content,"onUpdate:modelValue":r=>e.construction_content=r,placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{label:"项目建设目标",align:"center"},{default:n(({row:e})=>[t(p,{modelValue:e.project_goal,"onUpdate:modelValue":r=>e.project_goal=r,placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{label:"已完成目标",align:"center"},{default:n(({row:e})=>[t(p,{modelValue:e.completed_goal,"onUpdate:modelValue":r=>e.completed_goal=r,placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1}),t(c,{label:"过程材料上传",prop:"process_files",class:"ww100 flex-ss"},{default:n(()=>[t(V,{files:s(o).form.process_files,"onUpdate:files":l[4]||(l[4]=e=>s(o).form.process_files=e),contents:s(S),active:s(E)},null,8,["files","contents","active"])]),_:1}),t(c,{label:"实施成效文件上传",prop:"effect_files",class:"ww100 flex-ss"},{default:n(()=>[t(V,{files:s(o).form.effect_files,"onUpdate:files":l[5]||(l[5]=e=>s(o).form.effect_files=e),contents:s(j),active:s(T)},null,8,["files","contents","active"])]),_:1}),t(c,{label:"审批意见",prop:"approval_opinion",class:"ww100 flex-sc"},{default:n(()=>[t(p,{modelValue:s(o).form.approval_opinion,"onUpdate:modelValue":l[6]||(l[6]=e=>s(o).form.approval_opinion=e),type:"textarea",rows:4,placeholder:"请输入"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"]),i("div",ne,[i("div",{class:"plr14 ptb5 rad4 ml15 cursor white bgi1 bo-i1-1",onClick:l[7]||(l[7]=m(e=>s(o).actIndex--,["stop"]))},"上一步"),i("div",{class:"plr14 ptb5 rad4 ml15 cursor white bgi1 bo-i1-1",onClick:l[8]||(l[8]=m(e=>A(s(b)),["stop"]))},"保 存"),i("div",{class:"plr14 ptb5 rad4 ml15 cursor white bgi1 bo-i1-1",onClick:l[9]||(l[9]=m(e=>F(s(b)),["stop"]))},"提 交")])])])}}});export{me as _};
